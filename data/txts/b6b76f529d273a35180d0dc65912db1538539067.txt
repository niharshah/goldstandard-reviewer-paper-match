Minimally Supervised Categorization of Text with Metadata

Yu Zhang1âˆ—, Yu Meng1âˆ—, Jiaxin Huang1, Frank F. Xu2, Xuan Wang1, Jiawei Han1
1Department of Computer Science, University of Illinois at Urbana-Champaign, IL, USA 2Language Technologies Institute, Carnegie Mellon University, PA, USA
1{yuz9, yumeng5, jiaxinh3, xwang174, hanj}@illinois.edu, 2frankxu@cmu.edu

arXiv:2005.00624v3 [cs.CL] 13 Nov 2021

ABSTRACT
Document categorization, which aims to assign a topic label to each document, plays a fundamental role in a wide variety of applications. Despite the success of existing studies in conventional supervised document classification, they are less concerned with two real problems: (1) the presence of metadata: in many domains, text is accompanied by various additional information such as authors and tags. Such metadata serve as compelling topic indicators and should be leveraged into the categorization framework; (2) label scarcity: labeled training samples are expensive to obtain in some cases, where categorization needs to be performed using only a small set of annotated data. In recognition of these two challenges, we propose MetaCat, a minimally supervised framework to categorize text with metadata. Specifically, we develop a generative process describing the relationships between words, documents, labels, and metadata. Guided by the generative model, we embed text and metadata into the same semantic space to encode heterogeneous signals. Then, based on the same generative process, we synthesize training samples to address the bottleneck of label scarcity. We conduct a thorough evaluation on a wide range of datasets. Experimental results prove the effectiveness of MetaCat over many competitive baselines.
ACM Reference Format: Yu Zhang1âˆ—, Yu Meng1âˆ—, Jiaxin Huang1, Frank F. Xu2, Xuan Wang1, Jiawei Han1. 2020. Minimally Supervised Categorization of Text with Metadata. In Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval (SIGIR â€™20), July 25â€“30, 2020, Virtual Event, China. ACM, New York, NY, USA, 10 pages. https://doi.org/10.1145/ 3397271.3401168
1 INTRODUCTION
Our daily life is surrounded by a wealth of text data, ranging from news articles to social media and scientific publications. Document categorization (i.e., assigning a topic label to each document) serves as a critical first step towards organizing, searching and analyzing such a vast spectrum of text data. Many real applications, such as sentiment analysis [35] and location prediction [3], can also be cast as a document categorization task.
âˆ—Equal Contribution.
Permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. Copyrights for components of this work owned by others than ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or republish, to post on servers or to redistribute to lists, requires prior specific permission and/or a fee. Request permissions from permissions@acm.org. SIGIR â€™20, July 25â€“30, 2020, Virtual Event, China Â© 2020 Association for Computing Machinery. ACM ISBN 978-1-4503-8016-4/20/07. . . $15.00 https://doi.org/10.1145/3397271.3401168

Although deep neural models [12, 38] equipped with word embeddings [25] and pre-trained language models [4] have achieved superior performance on document categorization, existing studies are less concerned with two problems in real applications: (1) The presence of metadata: metadata prevalently exists in many data sources, especially social media platforms. For example, each tweet is associated with a Twitter user (i.e., its creator) and several hashtags; each Amazon/Yelp review has its product and user information. Such metadata makes each â€œdocumentâ€ a complex object beyond plain text. As a result, heterogeneous signals should be leveraged in the categorization process. (2) Label scarcity: conventional supervised text classification methods [12, 17, 29, 38] rely on a sufficient number of labeled documents as training data. However, annotating enough data for training classification models could be expensive. Moreover, manual labeling requires technical expertise in some domains (e.g., arXiv papers and GitHub repositories), which incurs additional cost. In these cases, it would be favorable to perform categorization using only a small set of training samples that an individual user can afford to provide.
Combining the statements above, we define our task as minimally supervised categorization of text with metadata. There exist previous attempts that incorporate metadata in text categorization [11, 26, 31]. For example, Kim et al. [11] customize embeddings, transformation matrices and encoder weights in the neural classifier according to metadata information. While it does improve classification accuracy, the model is designed under the fully supervised setting and requires massive training data. Along another line of work, researchers focus on text classification under weak supervision1 [23, 36]. However, they still view documents as plain text sequences and thus are not optimized under the presence of metadata.
In order to effectively leverage multi-modal signals and scarce labeled data jointly, in this paper, we propose a unified, embeddingbased categorization framework called MetaCat. The design of MetaCat contains two key ideas: (1) to deal with data heterogeneity, we embed words, documents, labels and various metadata (e.g., users, tags and products) into the same latent space to characterize their relationships; (2) to tackle label scarcity, we generate synthesized training samples based on the learned text and metadata embeddings. The generated data, together with the â€œrealâ€ training data, are used to train a neural classifier. We propose a generative model to simultaneously facilitate these two key ideas. Based on the generative process, our model (1) learns the embedding vectors of all elements via maximum likelihood estimation on the textual and metadata statistics; (2) synthesizes training samples with both text and metadata.
1Weak supervision implies that less than a dozen labeled documents are provided for each category.

User Description (Text) Tags
README (Text)

User Tweet (Text) Tags

Product

User

Title (Text)

Review (Text)

(a) GitHub Repository

(b) Tweet

(c) Amazon Review

Figure 1: Three examples of documents with metadata.

We conduct experiments on five real-world datasets from three different domains (GitHub repositories, tweets and Amazon reviews). The results reveal that MetaCat outperforms various textbased and graph-based benchmark approaches. Moreover, we show (1) the superiority of our embedding module towards heterogeneous network embedding methods [5, 6, 27] and (2) the significant contribution of our generation module under weak supervision.
To summarize, this paper makes the following contributions:
â€¢ We formulate the problem of minimally supervised categorization of text with metadata. It poses two unique challenges: data heterogeneity and label scarcity.
â€¢ We propose a principled generative process to characterize relationships between words, documents, labels and various metadata.
â€¢ We develop a novel framework MetaCat with an embedding module and a generation module to tackle the two challenges, respectively. Both modules are derived from the proposed generative process. We also provide theoretical interpretations of our design based on a spherical probabilistic model.
â€¢ We conduct extensive experiments to demonstrate the effectiveness of MetaCat and verify the contribution of both embedding and generation modules.
2 PRELIMINARIES
2.1 Problem Definition
Given a collection of documents D = {ğ‘‘1, ..., ğ‘‘ |D | } and a label space L = {ğ‘™1, ..., ğ‘™ |L | }, text classification aims to assign a class label ğ‘™ğ‘– to each document ğ‘‘ ğ‘— . To characterize each class ğ‘™ âˆˆ L, a set of labeled documents Dğ‘™ âŠ† D is provided as training data. Our problem is different from many previous text classification studies [12, 32, 38] from two perspectives. First, each document ğ‘‘ğ‘– is accompanied by some metadata ğ‘šğ‘– (which will be discussed in Section 2.2). Second, traditional supervised methods require sufficient annotated documents (i.e., |Dğ‘™ | is large), while we rely on minimal supervision where |Dğ‘™ | is small (e.g., less than a dozen). Formally, we define the problem as follows.
Definition 2.1. (Problem Definition) Given documents D, metadata M, label space L and a small set of training data {Dğ‘™ : ğ‘™ âˆˆ L}, the task is to assign a label ğ‘™ğ‘– âˆˆ L to each document ğ‘‘ ğ‘— âˆˆ D.

2.2 Text and Metadata
The presence of metadata is common in social media corpora. Let us start from some concrete examples. Figure 1 shows three â€œdocumentsâ€ extracted from different social media platforms. They contain various types of information, which can be grouped as follows.
Text. Textual information is the main body of a document. Some data may have multiple segments of text (e.g., Description+README in GitHub repositories, and Title+Review in Amazon reviews). To simplify our discussion, we concatenate them together for further utilization.
User/Author. The author of a document is a strong topic indicator because one person often has consistent interests. For example, in Figure 1(a), the user â€œtensorlayerâ€ publishes repositories mostly on deep learning; in Figure 1(b), we may infer that the user have many food-related tweets based on her self introduction.
Tag/Hashtag. Tags are a set of concepts describing the documents. Although more concise than text, they still suffer from noise and sparsity. For example, many hashtags in tweets appear only once, and over 70% of GitHub repositories in our collections have no tags. The major difference between words and tags is that words have orders in a sentence (thus local context information needs to be modeled), while tags are swappable.
Product. Product name information is distinctive in Amazon reviews. It is related to both the topic and the sentiment of reviews.
As we can see, the types of metadata are diverse. One can give even more varieties. However, in most cases, topic-indicative metadata can be divided into two major categories according to their relationships with documents.
Global Metadata. Global metadata â€œcausesâ€ the generation of documents. The semantics of a document is based on the semantics of its global metadata. For example, there first exists a user or a product, then some reviews are created by the user/for the product. This generative order cannot be reversed. Therefore, users and products are both global.
Local Metadata. Local metadata â€œdescribesâ€ the overall idea of a document. The semantics of local metadata is based on the semantics of its associated document. From this perspective, tags/hashtags are local. We can also say words in text are local, although they are beyond our discussion of â€œmetadataâ€.

User

Label

Doc

Word

Tag

Global Metadata

Label

Doc

Word

Local Metadata

(a) GitHub / Tweet

(b) The General Case

Figure 2: The generative process of text and metadata. The self loop of â€œWordâ€ represents the step of words generating contexts.

2.3 The Von Mises-Fisher Distribution

The von Mises-Fisher (vMF) distribution defines a probability den-

sity over points on a unit sphere. It is parameterized by a mean direction vector ğ and a concentration parameter ğœ…. Let Sğ‘âˆ’1 =

{ğ’™

âˆˆ

ğ‘
R

:

| |ğ’™ | |2

=

1}

denote

the

ğ‘ -dimensional

unit

sphere.

Then

the probability density function of vMFğ‘ (ğ, ğœ…) is defined as

ğ‘“vMF (ğ’™; ğ, ğœ…) = ğ‘ğ‘ (ğœ…) exp(ğœ…ğ’™ğ‘‡ ğ), ğ’™ âˆˆ Sğ‘âˆ’1,

where ||ğ ||2 = 1 and ğœ… > 0. The normalization constant ğ‘ğ‘ (ğœ…) is

given by

ğœ…ğ‘/2âˆ’1

ğ‘ğ‘ (ğœ…) =

,

(2ğœ‹ )ğ‘/2ğ¼ğ‘/2âˆ’1 (ğœ…)

where ğ¼ğ‘Ÿ (Â·) represents the modified Bessel function of the first kind

at order ğ‘Ÿ [7, 19]. Intuitively, the vMF distribution can be interpreted

as a normal distribution on the sphere. It characterizes data points

concentrating around the mean direction ğ, and they are more

concentrated if ğœ… is large.

3 METHOD
MetaCat consists of two key modules: embedding learning and training data generation, which are proposed to tackle data heterogeneity and label scarcity, respectively. We start this section by introducing a generative process (Figure 2) that guides the design of these two modules. Following this process, the embedding module learns representation vectors through maximizing the likelihood of observing all data, and the generation module synthesizes training documents with both text and metadata.
For the sake of clarity, we use a specific case (Figure 2(a)) to illustrate our framework. This is also the case of GitHub repositories and tweets. In Section 3.5, we discuss how to generalize the framework (Figure 2(b)).

3.1 The Generative Process
According to Figure 2(a), the generative process can be decomposed into four steps.
User & Label â†’ Document. When a user decides to write a document given a topic, s/he first has an overall idea of what to talk about. This â€œoverall ideaâ€ can be represented as document embedding ğ’†ğ‘‘ , which should be close to user embedding ğ’†ğ‘¢ and label embedding ğ’†ğ‘™ . Inspired by the softmax function in word2vec [25],

we define the generation probability as follows:

ğ‘ (ğ‘‘ |ğ‘¢, ğ‘™) âˆ exp(ğ’†ğ‘‡ ğ’†ğ‘¢ ) Â· exp(ğ’†ğ‘‡ ğ’†ğ‘™ ).

(1)

ğ‘‘

ğ‘‘

Document â†’ Word. Given the overall idea ğ’†ğ‘‘ , we can write down words that are coherent with the meaning of the entire document. To encourage such coherence, we have

ğ‘ (ğ‘¤ |ğ‘‘) âˆ exp(ğ’†ğ‘‡ğ‘¤ ğ’†ğ‘‘ ).

(2)

Document â†’ Tag. Tags can be generated similarly.

ğ‘ (ğ‘¡ |ğ‘‘) âˆ exp(ğ’†ğ‘‡ğ‘¡ ğ’†ğ‘‘ ).

(3)

Word â†’ Context. Different from tags, words in text carry sequential information. Tang et al. [32] point out that the embedding of a word is related to not only its global document representation (i.e., ğ’†ğ‘‘ ) but also its local context. To be specific, given a sequence of words ğ‘¤1ğ‘¤2...ğ‘¤ğ‘›, the local context of ğ‘¤ğ‘– is defined as C(ğ‘¤ğ‘–, â„) = {ğ‘¤ ğ‘— : ğ‘– âˆ’ â„ â‰¤ ğ‘— â‰¤ ğ‘– + â„, ğ‘– â‰  ğ‘— }, where â„ is the context window size. Mikolov et al. [25] propose the Skip-Gram model in which C(ğ‘¤ğ‘–, â„) is predicted given the center word ğ‘¤ğ‘– . Following [25], we define the generation probability to be

ğ‘ (C(ğ‘¤ğ‘–, â„)|ğ‘¤ğ‘– ) âˆ

exp(ğ’†â€² ğ‘‡ ğ’†ğ‘¤ ).

(4)

ğ‘¤ğ‘— ğ‘–

ğ‘¤ğ‘— âˆˆ C (ğ‘¤ğ‘– ,â„)

Note that each word ğ‘¤ has two embeddings: ğ’†ğ‘¤ when ğ‘¤ is viewed as a center word and ğ’†ğ‘¤â€² when ğ‘¤ is a context word [25].

Connections to the vMF Distribution. Now we explain how these conditional probabilities are related to the vMF distribution. Taking ğ‘ (ğ‘¤ |ğ‘‘) as an example, according to Eq. (2), we know that

exp(ğ’†ğ‘‡ğ‘¤ ğ’†ğ‘‘ )

ğ‘ (ğ‘¤ |ğ‘‘) =

,

(5)

ğ‘¤â€² âˆˆV exp(ğ’†ğ‘‡ğ‘¤â€² ğ’†ğ‘‘ )

where V is the vocabulary. Following [22], when |V | goes to infinity and the representation vectors of all elements are assumed to be unit vectors, we can generalize Eq. (5) to the continuous case:

exp(ğ’†ğ‘‡ğ‘¤ ğ’†ğ‘‘ )

lim ğ‘ (ğ‘¤ |ğ‘‘) = âˆ«

.

(6)

|V |â†’âˆ

Sğ‘âˆ’1 exp(ğ’†ğ‘‡ğ‘¤â€² ğ’†ğ‘‘ )ğ‘‘ğ’†ğ‘¤â€²

To calculate the denominator, one needs to note that the probability density function of vMF distribution integrates to 1 over the whole sphere. Therefore,

âˆ«

âˆ«

1=

ğ‘“vMF (ğ’†ğ‘¤â€² ; ğ’†ğ‘‘, 1)ğ‘‘ğ’†ğ‘¤â€² = ğ‘ğ‘ (1)

Sğ‘ âˆ’1

Combining Eqs. (6) and (7), we get

exp(ğ’†ğ‘‡ â€² ğ’†ğ‘‘ )ğ‘‘ğ’†ğ‘¤â€² .

Sğ‘ âˆ’1

ğ‘¤

(7)

lim ğ‘ (ğ‘¤ |ğ‘‘) = ğ‘ğ‘ (1) exp(ğ’†ğ‘‡ğ‘¤ ğ’†ğ‘‘ ) = vMFğ‘ (ğ’†ğ‘‘, 1). (8)
|V |â†’âˆ

Similarly, lim ğ‘ (ğ‘‘ |ğ‘¢, ğ‘™) âˆ vMFğ‘ (ğ’†ğ‘¢, 1) Â· vMFğ‘ (ğ’†ğ‘™ , 1),
| D |â†’âˆ

lim ğ‘ (ğ‘¡ |ğ‘‘) = vMFğ‘ (ğ’†ğ‘‘, 1),
| T |â†’âˆ

(9)

lim ğ‘ (ğ‘¤ ğ‘— |ğ‘¤ğ‘– ) = vMFğ‘ (ğ’†ğ‘¤ , 1),

|V |â†’âˆ

ğ‘–

where T is the set of tags appearing in the corpus. The probability ğ‘ (ğ‘‘ |ğ‘¢, ğ‘™) needs to be elaborated more here. Dur-
ing our embedding step, ğ‘™ is unknown in many cases because only a small proportion of documents have label information. When ğ‘™

is missing, it is natural to assume that ğ’†ğ‘™ can be any vector on the sphere with equal probability (i.e., ğ’†ğ‘™ âˆ¼ ğ‘ˆ (Sğ‘âˆ’1)). In this case, Eq.
(1) becomes

ğ‘ (ğ‘‘ |ğ‘¢, ğ‘™) âˆ Eğ’†ğ‘™ âˆ¼ğ‘ˆ (Sğ‘âˆ’1) [exp(ğ’†ğ‘‡ğ‘‘ ğ’†ğ‘¢ ) Â· exp(ğ’†ğ‘‡ğ‘‘ ğ’†ğ‘™ )] (10) = exp(ğ’†ğ‘‡ğ‘‘ ğ’†ğ‘¢ ) Â· Eğ’†ğ‘™ âˆ¼ğ‘ˆ (Sğ‘âˆ’1) [exp(ğ’†ğ‘‡ğ‘‘ ğ’†ğ‘™ )].

For any fixed ğ’†ğ‘‘ , using Eq. (7), we have

âˆ«

Eğ’†

âˆ¼ğ‘ˆ

( Sğ‘ âˆ’1 )

[exp(ğ’†ğ‘‡
ğ‘‘

ğ’†ğ‘™ )]

âˆ

exp(ğ’†ğ‘‡ ğ’†ğ‘™ )ğ‘‘ğ’†ğ‘™ = 1/ğ‘ğ‘ (1). (11)
ğ‘‘

ğ‘™

Sğ‘ âˆ’1

In other words, this term is the same for any ğ’†ğ‘‘ âˆˆ Sğ‘âˆ’1. Therefore,

when there is no label information,

ğ‘ (ğ‘‘ |ğ‘¢, ğ‘™) âˆ exp(ğ’†ğ‘‡ ğ’†ğ‘¢ ).

(12)

ğ‘‘

Our assumption that all embeddings are unit vectors has empirical bases because normalizing embeddings onto a sphere is common practice in natural language processing [13, 37].

3.2 Generation-Guided Embedding Learning

Given the generative process, we are able to learn ğ’†ğ‘¢ , ğ’†ğ‘™ , ğ’†ğ‘‘ , ğ’†ğ‘¡ , ğ’†ğ‘¤ and ğ’†ğ‘¤â€² through maximum likelihood estimation.
Likelihood. Assume all embedding vectors are parameters of our generative model. The likelihood of observing the whole corpus (including metadata) is

J = ğ‘ (ğ‘‘ |ğ‘¢ğ‘‘, ğ‘™ğ‘‘ ) Â·

ğ‘ (ğ‘¡ |ğ‘‘)Â·

ğ‘‘âˆˆD

ğ‘‘ âˆˆ D ğ‘¡ âˆˆ Tğ‘‘

(13)

ğ‘ (ğ‘¤ğ‘– |ğ‘‘)ğ‘ (C(ğ‘¤ğ‘–, â„)|ğ‘¤ğ‘– ),

ğ‘‘ âˆˆ D ğ‘¤ğ‘–

where ğ‘¢ğ‘‘ is the user creating document ğ‘‘; ğ‘™ğ‘‘ is the label of document ğ‘‘; Tğ‘‘ is the set of tags in ğ‘‘. If ğ‘‘ is not labeled (i.e., ğ‘™ğ‘‘ is unknown), according to Eq. (12),

exp(ğ’†ğ‘‡ ğ’†ğ‘¢ )

ğ‘ (ğ‘‘ |ğ‘¢ğ‘‘, ğ‘™ğ‘‘ ) =

ğ‘‘ğ‘‘
.

(14)

ğ‘‘â€² âˆˆD exp(ğ’†ğ‘‡ğ‘‘â€² ğ’†ğ‘¢ğ‘‘ )

If ğ‘‘ is labeled, according to Eq. (1),

exp(ğ’†ğ‘‡ ğ’†ğ‘¢ ) exp(ğ’†ğ‘‡ ğ’†ğ‘™ )

ğ‘ (ğ‘‘ |ğ‘¢ğ‘‘, ğ‘™ğ‘‘ ) =

ğ‘‘ğ‘‘

ğ‘‘ğ‘‘

exp(ğ’†ğ‘‡â€² ğ’†ğ‘¢ ) exp(ğ’†ğ‘‡â€² ğ’†ğ‘™ )

ğ‘‘â€² âˆˆD ğ‘‘ ğ‘‘ ğ‘‘ ğ‘‘ (15)

exp(ğ’†ğ‘‡ ğ’†ğ‘¢ )

exp(ğ’†ğ‘‡ ğ’†ğ‘™ )

âˆ

ğ‘‘ğ‘‘

Â·

ğ‘‘ğ‘‘
.

ğ‘‘â€² âˆˆD exp(ğ’†ğ‘‡ğ‘‘â€² ğ’†ğ‘¢ğ‘‘ ) ğ‘‘â€² âˆˆD exp(ğ’†ğ‘‡ğ‘‘â€² ğ’†ğ‘™ğ‘‘ )

Similarly, other conditional probabilities can be derived using Eqs. (2)-(4). Therefore,

âˆ‘ï¸ âˆ‘ï¸

log J =

log

ğ‘¢âˆˆU ğ‘‘ âˆˆDğ‘¢

exp(ğ’†ğ‘‡ ğ’†ğ‘¢ ) âˆ‘ï¸ âˆ‘ï¸

ğ‘‘

+

log

ğ‘‘â€² exp(ğ’†ğ‘‡â€² ğ’†ğ‘¢ )
ğ‘‘

ğ‘™âˆˆL ğ‘‘âˆˆD

ğ‘™

exp(ğ’†ğ‘‡ ğ’†ğ‘™ )
ğ‘‘
ğ‘‘â€² exp(ğ’†ğ‘‡â€² ğ’†ğ‘™ )
ğ‘‘

âˆ‘ï¸ âˆ‘ï¸

+

log

ğ‘‘

âˆˆD

ğ‘¡

âˆˆT ğ‘‘

exp(ğ’†ğ‘‡ğ‘¡ ğ’†ğ‘‘ ) + âˆ‘ï¸ âˆ‘ï¸ log

ğ‘¡â€² exp(ğ’†ğ‘‡â€² ğ’†ğ‘‘ )
ğ‘¡

ğ‘‘âˆˆD ğ‘¤

ğ‘–

exp(ğ’†ğ‘‡ğ‘¤ ğ’†ğ‘‘ )
ğ‘–
ğ‘¤â€² exp(ğ’†ğ‘‡ â€² ğ’†ğ‘‘ )
ğ‘¤

âˆ‘ï¸ âˆ‘ï¸ âˆ‘ï¸

+

log

ğ‘‘ âˆˆD ğ‘¤ğ‘– ğ‘¤ğ‘— âˆˆC (ğ‘¤ğ‘– ,â„)

exp(ğ’†â€² ğ‘‡ ğ’†ğ‘¤ )

ğ‘¤ğ‘— ğ‘– + const.

ğ‘¤â€²

exp

(

ğ’†

â€²

ğ‘‡ â€²

ğ’†ğ‘¤

)

ğ‘¤ğ‘–

(16)

Here U is the set of users in the dataset; Dğ‘¢ is the set of documents
belonging to user ğ‘¢; Dğ‘™ is the set of documents (in the training set) with label ğ‘™. ğ’†ğ‘¢ , ğ’†ğ‘™ , ğ’†ğ‘‘ , ğ’†ğ‘¡ , ğ’†ğ‘¤ and ğ’†ğ‘¤â€² can be learned by maximizing

log J . However, the denominators in Eq. (16) require summing over all documents/tags/words, which is computationally expensive. Following common practice, in our actual computation, we estimate these terms through negative sampling [25, 33].
Comparisons with Heterogeneous Network Embedding. There are various ways to encode multi-modal signals, among which Heterogeneous Information Network (HIN) embedding [5, 6, 27] is commonly used. In fact, if we remove the edge directions in Figure 2(a), it can also be viewed as an HIN schema [30]. We would like to emphasize two key differences between our method and HIN embedding. First, HIN models connections between different types of nodes, while our approach models generative relationships. Not all connections can be explained as a generative story. From this perspective, our method is more specifically designed to encode text with metadata information. Second, many HIN embedding methods [5, 27] require users to specify a set of meta-paths [30], which is not needed in our approach.

3.3 Training Data Generation

To deal with label scarcity, we consider to generate synthesized training data. In Figure 2, we have proposed a generative process to characterize heterogeneous signals in both text and metadata. Our embedding module follows this process, and so will our generation module. To be specific, given a label ğ‘™, we first generate a document vector ğ‘’ğ‘‘ from ğ‘ (ğ‘‘ |ğ‘¢, ğ‘™) and then sample words and tags one by one from ğ‘ (ğ‘¤ |ğ‘‘) and ğ‘ (ğ‘¡ |ğ‘‘). Formally,

ğ‘›

ğ‘š

ğ‘ (ğ‘‘, ğ‘¤1:ğ‘›, ğ‘¡1:ğ‘š |ğ‘¢, ğ‘™) = ğ‘ (ğ‘‘ |ğ‘¢, ğ‘™) Â· ğ‘ (ğ‘¤ğ‘– |ğ‘‘) Â· ğ‘ (ğ‘¡ ğ‘— |ğ‘‘). (17)

ğ‘– =1

ğ‘— =1

Unlike in the case of embedding, when we tend to generate new documents, ğ‘¢ is not observable. Also, there is no need to generate training data for a specific existing user because our task is to predict the label, not the user, of each document. If ğ‘¢ is assumed to be unknown, following the derivation of Eqs. (10)-(12), we have

ğ‘ (ğ‘‘ |ğ‘¢, ğ‘™) âˆ exp(ğ’†ğ‘‡ ğ’†ğ‘™ ).

(18)

ğ‘‘

In principle, we are able to generate as many documents as we want. In other words, there is an infinite number of documents (i.e., ğ’†ğ‘‘ ) distributed on the sphere, and we are essentially picking some of them as synthesized training samples. Similar to Eq. (8), by assuming |D| â†’ âˆ, we have

ğ‘ (ğ‘‘ |ğ‘¢, ğ‘™) = vMFğ‘ (ğ’†ğ‘™ , ğœ…).

(19)

The generation of words and tags, however, is different. The semantics of words and tags are discretely distributed in the latent space. To be specific, not every unit vector can be mapped back to an existing word or tag in the vocabulary. Therefore, we still assume |V | and |T | are finite in our generation step, and the generated words or tags must have appeared in V or T . Then the generation probabilities simply follow Eqs. (2) and (3). In practice, the computation of ğ‘¤â€² âˆˆV exp(ğ’†ğ‘‡ğ‘¤â€² ğ’†ğ‘‘ ) could be quite expensive. Therefore, we restrict the word/tag candidates to be the top-ğœ ones similar with ğ’†ğ‘‘ on the sphere (denoted as N (ğ’†ğ‘‘ )), and the conditional probabilities will be modified as

exp(ğ’†ğ‘‡ğ‘¤ ğ’†ğ‘‘ )

ğ‘ (ğ‘¤ğ‘– |ğ‘‘) =

ğ‘–

, ğ‘¤ğ‘– âˆˆ N (ğ’†ğ‘‘ ), (20)

ğ‘¤â€² âˆˆN (ğ’†ğ‘‘ ) exp(ğ’†ğ‘‡ğ‘¤â€² ğ’†ğ‘‘ )

and

exp(ğ’†ğ‘‡ğ‘¡ğ‘— ğ’†ğ‘‘ )

âˆˆ N (ğ’† ). (21)

ğ‘ (ğ‘¡ ğ‘— |ğ‘‘) =

, ğ‘¡ğ‘—

ğ‘‘

ğ‘¡â€² âˆˆN (ğ’† ) exp(ğ’†ğ‘‡â€² ğ’†ğ‘‘ )

ğ‘‘

ğ‘¡

Plugging Eqs. (19), (20) and (21) into Eq. (17) fully specifies our

generation step. Each generated document has a label, a sequence

of words and a set of tags. We denote the set of synthesized training document for class ğ‘™ as Dâˆ—.
ğ‘™

3.4 Neural Model Training

We now need to feed the synthesized training data {Dâˆ— : ğ‘™ âˆˆ L},
ğ‘™

together with the â€œrealâ€ training data {Dğ‘™ : ğ‘™ âˆˆ L}, into a classifier.

Here each document (either synthesized or real) can be viewed as

a sequence of words ğ‘¤1:ğ‘› and tags ğ‘¡1:ğ‘š. The input of the classifier

is pre-trained embeddings {ğ’†ğ‘¤ : ğ‘¤ âˆˆ V} and {ğ’†ğ‘¡ : ğ‘¡ âˆˆ T }. This

setting is generic enough so that many neural classifiers, such

as CNN [12], HAN [38], CNN-LSTM [43], BiGRU-CNN [34] and

DPCNN [10], can be applied in our framework. Developing an

advanced neural classifier is not a goal of this paper. Instead, we

aim to show the power of our embedding and generation modules.

Their contribution to the performance should not be covered by

advanced neural architectures when comparing with baselines.

Therefore, we choose CNN [12], a simple but widely used model as

our text classifier. We also tried HAN [38], a representative RNN-

based classifier, but it performs slightly worse than CNN on our

datasets.

In the CNN architecture, each document is represented by the

concatenation of its word and tag embeddings ğ’†1:ğ‘›+ğ‘š = [ğ’†ğ‘¤1, ...,

ğ’†ğ‘¤ ğ‘›

,

ğ’†ğ‘¡1

,

...,

ğ’†ğ‘¡ğ‘š

]

.

There

is

one

convolutional

layer,

in

which

a

con-

volution filter is applied to a text region ğ’†ğ‘–:ğ‘–+â„âˆ’1.

ğ‘ğ‘– = ğœ (ğ’˜ğ‘‡ ğ’†ğ‘–:ğ‘–+â„âˆ’1 + ğ’ƒ),

(22)

where ğœ is the sigmoid function. All ğ‘ğ‘– â€™s together form a feature

map ğ’„ = [ğ‘1, ..., ğ‘ğ‘›+ğ‘šâˆ’â„+1] associated with the filter. Then a max-

over-time pooling operation is performed on ğ’„. In this paper, we

use filters with â„ = 2, 3, 4 and 5. For each width â„, we generate

20 feature maps. After pooling, the features are passed through

a fully connected softmax layer whose output is the probability

distribution over labels.

Following [38], we use negative log-likelihood of the correct la-

bels as training loss. Formally, given all training samples (including

both real and synthesized ones), assume the ğ‘–-th one has label ğ‘™ğ‘ (ğ‘–).

Then âˆ‘ï¸

loss = âˆ’ log ğ‘ğ‘–,ğ‘™ğ‘ (ğ‘–),

(23)

ğ‘–
where ğ’’ğ‘– is the neural network output distribution of the ğ‘–-th instance.

3.5 The General Version of Our Framework
Although we illustrate our framework using Figure 2(a), MetaCat can be easily generalized to any generative process following Figure 2(b). To be specific, let MG be the set of global metadata variables and ML be the set of local metadata variables. (For example, in the cases of GitHub repositories and tweets, MG = {ğ‘¢ğ‘ ğ‘’ğ‘Ÿ } and ML = {ğ‘¡ğ‘ğ‘”}; in the case of Amazon reviews, MG = {ğ‘¢ğ‘ ğ‘’ğ‘Ÿ, ğ‘ğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡ } and ML = âˆ….) The generative process can be described as follows:

Global Metadata & Label â†’ Document.

ğ‘ (ğ‘‘ |MG, ğ‘™) âˆ exp(ğ’†ğ‘‡ğ‘‘ ğ’†ğ‘™ ) Â· exp(ğ’†ğ‘‡ğ‘‘ ğ’†ğ‘§ ). (24)
ğ‘§ âˆˆMG

Document â†’ Word & Local Metadata.

ğ‘ (ğ‘¤, ML |ğ‘‘) âˆ exp(ğ’†ğ‘‡ğ‘¤ ğ’†ğ‘‘ ) Â·

exp(ğ’†ğ‘‡ğ‘§ ğ’†ğ‘‘ ).

(25)

ğ‘§ âˆˆML

Word â†’ Context.

ğ‘ (C(ğ‘¤ğ‘–, â„)|ğ‘¤ğ‘– ) âˆ

exp(ğ’†â€² ğ‘‡ ğ’†ğ‘¤ ).

(26)

ğ‘¤ğ‘— ğ‘–

ğ‘¤ğ‘— âˆˆ C (ğ‘¤ğ‘– ,â„)

Given the generative process, the derivations of embedding learning and training data generation are quite similar to those in Sections 3.2 and 3.3. We directly show the results here.

Embedding Learning. The log-likelihood is

âˆ‘ï¸ âˆ‘ï¸

log J =

log

ğ‘§âˆˆZG ğ‘‘ âˆˆDğ‘§

exp(ğ’†ğ‘‡ ğ’†ğ‘§ ) âˆ‘ï¸ âˆ‘ï¸

ğ‘‘

+

log

ğ‘‘â€² exp(ğ’†ğ‘‡â€² ğ’†ğ‘§ )
ğ‘‘

ğ‘™âˆˆL ğ‘‘âˆˆD

ğ‘™

exp(ğ’†ğ‘‡ ğ’†ğ‘™ )
ğ‘‘
ğ‘‘â€² exp(ğ’†ğ‘‡â€² ğ’†ğ‘™ )
ğ‘‘

âˆ‘ï¸ âˆ‘ï¸

+

log

ğ‘‘âˆˆD ğ‘§âˆˆZ ğ‘‘

exp(ğ’†ğ‘‡ğ‘§ ğ’†ğ‘‘ ) + âˆ‘ï¸ âˆ‘ï¸ log

ğ‘§â€² exp(ğ’†ğ‘‡â€² ğ’†ğ‘‘ )
ğ‘§

ğ‘‘âˆˆD ğ‘¤

ğ‘–

exp(ğ’†ğ‘‡ğ‘¤ ğ’†ğ‘‘ )
ğ‘–
ğ‘¤â€² exp(ğ’†ğ‘‡ â€² ğ’†ğ‘‘ )
ğ‘¤

âˆ‘ï¸ âˆ‘ï¸ âˆ‘ï¸

+

log

ğ‘‘ âˆˆD ğ‘¤ğ‘– ğ‘¤ğ‘— âˆˆC (ğ‘¤ğ‘– ,â„)

exp(ğ’†â€² ğ‘‡ ğ’†ğ‘¤ )

ğ‘¤ğ‘— ğ‘– + const.

ğ‘¤â€²

exp

(

ğ’†

â€²

ğ‘‡ â€²

ğ’†ğ‘¤

)

ğ‘¤ğ‘–

(27)

Here ZG is the set of global metadata instances (e.g., ZG = U for GitHub repositories and tweets, and ZG = U âˆª P for Amazon reviews, where P is the set of products); Dğ‘§ is the set of documents belonging to a global metadata instance ğ‘§; Zğ‘‘ is the set of local metadata instances associated with document ğ‘‘ (e.g., Zğ‘‘ = Tğ‘‘ for GitHub repositories and tweets, and Zğ‘‘ = âˆ… for Amazon reviews). All embeddings can be learned by maximizing this likelihood.

Training Data Generation. Given label ğ‘™, we first generate ğ‘’ğ‘‘ from ğ‘ (ğ‘‘ |MG, ğ‘™) and then sample words ğ‘¤ğ‘– and local metadata instances ğ‘§ ğ‘— from ğ‘ (ğ‘¤ |ğ‘‘) and ğ‘ (ğ‘§|ğ‘‘), respectively.

ğ‘›

ğ‘š

ğ‘ (ğ‘‘, ğ‘¤1:ğ‘›, ğ‘§1:ğ‘š |MG, ğ‘™) = ğ‘ (ğ‘‘ |MG, ğ‘™) Â· ğ‘ (ğ‘¤ğ‘– |ğ‘‘) Â· ğ‘ (ğ‘§ ğ‘— |ğ‘‘).

ğ‘– =1

ğ‘— =1

(28)

The generation of documents follows Eq. (19). By assuming MG is

not observable and |D| â†’ âˆ, we have

ğ‘ (ğ‘‘ |MG, ğ‘™) = vMFğ‘ (ğ’†ğ‘™ , ğœ…).

(29)

The generation of words and local metadata follows Eqs. (20) and (21), where we only need to replace ğ‘¡ ğ‘— with ğ‘§ ğ‘— .

4 EXPERIMENTS
In order to provide evidence for the efficacy of MetaCat, we experiment with five datasets collected from different domains. Specifically, we aim to show that (1) MetaCat outperforms benchmark approaches by a clear margin; (2) the proposed generation-guided embedding module captures multi-modal semantics better than existing meta-path based HIN embedding techniques; (3) incorporating synthesized training samples can significantly boost the classification performance.

Table 1: Dataset Statistics.

Dataset GitHub-Bio [42] GitHub-AI [42]
GitHub-Sec Amazon [20] Twitter [40]

#Document 876 1,596
84,950 100,000 135,529

#Class 10 14 3 10 9

#Training 100 140 30 100 90

#Testing 776 1,456
84,920 99,900 135,439

4.1 Datasets
The five datasets we use are collected from three different sources: GitHub repositories, Amazon reviews and Twitter posts.2
â€¢ GitHub-Bio [42]. This dataset is extracted from four bioinformatics venues from 2014 to 2018. Each GitHub repository is associated with a research article published on these venues. The issue section (e.g., sequence analysis, genome analysis, systems biology, etc.) of the article is viewed as the topic label of the associated repository.
â€¢ GitHub-AI [42]. This dataset is collected by the Paper With Code project. It contains a list of GitHub repositories implementing algorithms of various machine learning tasks (e.g., image generation, machine translation, speech recognition, etc.). Each task is viewed as a topic label.
â€¢ GitHub-Sec. This dataset is obtained from the DARPA SocialSim Challenge. It contains GitHub repositories related to cryptocurrency, cybersecurity or software vulnerability.
â€¢ Amazon [20]. This dataset is a large crawl of Amazon product reviews. The topic label of each review is its product category (e.g., books, home & kitchen, sports & outdoors, etc.). We select 10 large categories and sample 10,000 reviews from each category.
â€¢ Twitter [40]. This dataset contains geo-tagged tweets in New York City during 2014.08.01 â€“ 2014.11.30. The authors link the tweets with Foursquareâ€™s POI database, and the topic label of each tweet is the type of the linked POI (e.g., shop & service, college & university, nightlife spot, etc.).
We use 10 documents in each class for training and all the others for testing (i.e., |Dğ‘™ | = 10). Brief statistics of the five datasets are summarized in Table 1.

4.2 Baseline Methods
We evaluate the performance of MetaCat against both text-based and graph-based benchmark approaches:
â€¢ CNN [12] is a supervised text classification method. It trains a convolutional neural network with a max-over-time pooling layer.
â€¢ HAN [38] is a supervised text classification method. It trains a hierarchical attention network and uses GRU to encode word sequences.
â€¢ PTE [32] is a semi-supervised approach. It constructs a network with three subgraphs (word-word, word-document and word-label) and embeds nodes based on first and second order proximities.
â€¢ WeSTClass [23] is a weakly supervised text classification approach. It models topic semantics in the word2vec embedding space and applies a pre-training and self-training scheme.
2Our code and datasets are available at https://github.com/yuzhimanhua/MetaCat.

â€¢ PCEM [36] is a weakly supervised hierarchical text classification method using path cost-sensitive learning. In our problem setting, the label hierarchy has only one layer.
â€¢ BERT [4] is a state-of-the-art pre-trained language model that provides contextualized word representations. Here we fine-tune BERT under the supervised text classification setting using labeled documents.
â€¢ ESim [27] is an HIN embedding approach. It learns node embeddings using meta-path guided sequence sampling and noisecontrastive estimation.
â€¢ Metapath2vec [5] is an HIN embedding approach. It samples node sequences through heterogeneous random walks and incorporates negative sampling.
â€¢ HIN2vec [6] is an HIN embedding approach that exploits different types of links among nodes.
â€¢ TextGCN [39] is a semi-supervised text classification approach. It applies graph neural networks on the document-word cooccurrence graph.
For ESim, Metapath2vec and HIN2vec, we construct an HIN by viewing Figure 2 as the HIN schema. Based on the schema, we select five meta-paths ğ‘‘ğ‘œğ‘-ğ‘¢ğ‘ ğ‘’ğ‘Ÿ -ğ‘‘ğ‘œğ‘, ğ‘‘ğ‘œğ‘-ğ‘™ğ‘ğ‘ğ‘’ğ‘™-ğ‘‘ğ‘œğ‘, ğ‘‘ğ‘œğ‘-ğ‘¤ğ‘œğ‘Ÿğ‘‘-ğ‘‘ğ‘œğ‘, ğ‘‘ğ‘œğ‘-ğ‘¡ğ‘ğ‘”-ğ‘‘ğ‘œğ‘ and ğ‘¤ğ‘œğ‘Ÿğ‘‘-ğ‘¤ğ‘œğ‘Ÿğ‘‘ to guide the embedding. (On Amazon, we replace ğ‘‘ğ‘œğ‘-ğ‘¡ğ‘ğ‘”-ğ‘‘ğ‘œğ‘ with ğ‘‘ğ‘œğ‘-ğ‘ğ‘Ÿğ‘œğ‘‘ğ‘¢ğ‘ğ‘¡-ğ‘‘ğ‘œğ‘.) After the node embedding step, we get representation vectors of each word/tag. Then, we train a CNN classifier using original training data {Dğ‘™ : ğ‘™ âˆˆ L} and the pre-trained HIN embeddings.
For all baselines using the CNN classifier (i.e., CNN, WeSTClass, ESim, Metapath2vec and HIN2vec), we adopt the architecture in Section 3.4 (the same as MetaCat) to align the experiment settings. For HAN, we use a forward GRU with 100 dimension for both word and sentence encoding. The training process of all neural classifiers is performed using SGD with a batch size of 256. The dimension of all embedding vectors is 100 (except BERT whose base model is set to be 768-dimensional).
For MetaCat, we set the local context window size â„ = 5, the document-specific vocabulary size |N (ğ’†ğ‘‘ )| = 50, and the number of generated training samples per class |Dâˆ—| = 100.
ğ‘™
4.3 Performance Comparison
Tables 2 and 3 demonstrate the Micro and Macro F1 scores of compared methods on the five datasets. We repeat each experiment 5 times with the mean and standard deviation reported. We cannot get the performance of TextGCN on GitHub-Sec and Amazon because the model (i.e., the constructed graph) is too large to fit into our GPU with 11GB memory. (The Twitter dataset can fit because it has a much smaller average document length.)
As we can observe from Tables 2 and 3: (1) MetaCat consistently outperforms all baselines by a clear margin on all datasets. It achieves a 4.3% absolute improvement on average in comparison with TextGCN, the second best approach in our table. When comparing with other baselines, our absolute improvement is over 10%. (2) In contrast to methods using plain text embeddings (i.e., CNN, HAN and WeSTClass), the performance boosts of MetaCat are more significant on smaller datasets (i.e., GitHub-Bio and GitHubAI). In fact, when the corpus is small, word2vec cannot generate high-quality word embeddings. Consequently, neural models using

Table 2: Micro F1 scores of compared algorithms on the five datasets. â€œâ€“â€: excessive memory requirements.

Type Text-based Graph-based

Method CNN [12] HAN [38] PTE [32] WeSTClass [23] PCEM [36] BERT [4] ESim [27] Metapath2vec [5] HIN2vec [6] TextGCN [39] MetaCat

GitHub-Bio 0.2227 Â± 0.0195 0.1409 Â± 0.0145 0.3170 Â± 0.0516 0.3680 Â± 0.0138 0.3426 Â± 0.0160 0.2680 Â± 0.0303 0.2925 Â± 0.0223 0.3956 Â± 0.0141 0.2564 Â± 0.0131 0.4759 Â± 0.0126
0.5258 Â± 0.0090

GitHub-AI 0.2404 Â± 0.0404 0.1900 Â± 0.0299 0.3511 Â± 0.0403 0.5036 Â± 0.0287 0.4820 Â± 0.0292 0.2451 Â± 0.0273 0.4376 Â± 0.0323 0.4444 Â± 0.0231 0.3614 Â± 0.0234 0.6353 Â± 0.0059
0.6889 Â± 0.0128

GitHub-Sec 0.4909 Â± 0.0489 0.4677 Â± 0.0334 0.4551 Â± 0.0249 0.6146 Â± 0.0084 0.5912 Â± 0.0341 0.5538 Â± 0.0368 0.5480 Â± 0.0109 0.5772 Â± 0.0594 0.5218 Â± 0.0466
â€“
0.7243 Â± 0.0336

Amazon 0.4915 Â± 0.0374 0.4809 Â± 0.0372 0.2997 Â± 0.0786 0.5312 Â± 0.0161 0.4645 Â± 0.0163 0.5240 Â± 0.0261 0.5320 Â± 0.0246 0.5256 Â± 0.0335 0.4987 Â± 0.0252
â€“
0.6422 Â± 0.0058

Twitter 0.3106 Â± 0.0613 0.3163 Â± 0.0878 0.1945 Â± 0.0250 0.3568 Â± 0.0178 0.2387 Â± 0.0344 0.3312 Â± 0.0860 0.3512 Â± 0.0226 0.3516 Â± 0.0407 0.2944 Â± 0.0614 0.3361 Â± 0.0032
0.3971 Â± 0.0169

Table 3: Macro F1 scores of compared algorithms on the five datasets. â€œâ€“â€: excessive memory requirements.

Type Text-based Graph-based

Method CNN [12] HAN [38] PTE [32] WeSTClass [23] PCEM [36] BERT [4] ESim [27] Metapath2vec [5] HIN2vec [6] TextGCN [39] MetaCat

GitHub-Bio 0.1896 Â± 0.0133 0.0677 Â± 0.0208 0.2630 Â± 0.0371 0.3414 Â± 0.0129 0.2977 Â± 0.0281 0.1740 Â± 0.0164 0.2598 Â± 0.0182 0.3214 Â± 0.0128 0.2742 Â± 0.0136 0.4817 Â± 0.0078
0.5230 Â± 0.0080

GitHub-AI 0.1796 Â± 0.0216 0.0961 Â± 0.0254 0.3363 Â± 0.0250 0.4056 Â± 0.0248 0.3751 Â± 0.0350 0.2083 Â± 0.0415 0.3209 Â± 0.0202 0.3220 Â± 0.0290 0.2513 Â± 0.0211 0.5997 Â± 0.0013
0.6154 Â± 0.0079

GitHub-Sec 0.4268 Â± 0.0584 0.4095 Â± 0.0590 0.3803 Â± 0.0218 0.5497 Â± 0.0054 0.4033 Â± 0.0336 0.4956 Â± 0.0164 0.4672 Â± 0.0171 0.5140 Â± 0.0637 0.4000 Â± 0.0115
â€“
0.6323 Â± 0.0235

Amazon 0.5056 Â± 0.0376 0.4644 Â± 0.0597 0.2563 Â± 0.0810 0.5234 Â± 0.0147 0.4239 Â± 0.0237 0.4911 Â± 0.0544 0.5336 Â± 0.0220 0.5239 Â± 0.0437 0.4261 Â± 0.0284
â€“
0.6496 Â± 0.0091

Twitter 0.2858 Â± 0.0559 0.2592 Â± 0.0826 0.1739 Â± 0.0190 0.3085 Â± 0.0398 0.2039 Â± 0.0472 0.2834 Â± 0.0550 0.3399 Â± 0.0113 0.3443 Â± 0.0208 0.2411 Â± 0.0142 0.3191 Â± 0.0029
0.3612 Â± 0.0067

word2vec embeddings will not achieve satisfying performance. In this case, leveraging multi-modal signals in representation learning becomes necessary. (3) Despite its great success in supervised tasks, BERT is not suitable for our task without sufficient training data, probably because the language style of GitHub files and tweets are different from that of Wikipedia, which might require strong supervision for fine-tuning. (4) Although HIN embedding techniques (i.e., ESim, Metapath2vec and HIN2vec) consider data heterogeneity and utilize unlabeled data during the embedding step, they still do not address the label scarcity bottleneck when training the classifier. This leads to their inferiority towards MetaCat.
4.4 Effect of Embedding Learning
Embedding Method. Tables 2 and 3 tell us that our generationguided embedding module, together with training data generation, can outperform several HIN embedding baselines. Now, to further explore the effectiveness of the proposed embedding technique, we perform a â€œfairerâ€ comparison by fixing all the other parts in MetaCat and vary the embedding module only.
To be specific, we can use ESim, Metapath2vec and HIN2vec to replace our current embedding technique, which generates three ablations ESim-as-embedding, Mp2v-as-embedding and H2v-asembedding. Moreover, we exploit various metadata as well as word context information during the embedding process. To demonstrate their contributions, we create three ablations No-User, NoContext, and No-Tag (No-Product for the Amazon dataset). Here No-User means we do not consider user information during embedding. Similar meanings can be inferred for the other two ablations. Note that our generation step needs ğ’†ğ‘™ and ğ’†ğ‘¤, so there is

no so-called â€œNo-Labelâ€ or â€œNo-Wordâ€. Figures 3 and 4 show the performance of these variants and our Full model.
We have the following observations: (1) Full outperforms ESimas-embedding, Mp2v-as-embedding and H2v-as-embedding on almost all datasets, with only one exception where ESim-as-embedding performs the best on Amazon. On the other four datasets, the average absolute improvement of Full in comparison with ESim-asembedding (resp., Mp2v-as-embedding) is 4.0% (resp., 2.5%) in terms of Micro F1. This finding demonstrates the advantage of our generation-guided embedding over meta-path based HIN embedding in this task. As mentioned above, ESim and Metapath2vec rely on meta-path guided random walks to model higher-order relationships between nodes. However, in our task, there is an evident generative process, with which we believe that characterizing generative relationships between various elements is more important than describing long-distance connections. (2) Full consistently outperforms the ablations ignoring different metadata, indicating that users, tags, products and contexts all play a positive role in classification. Meanwhile, their importance varies in different datasets. For example, product information is extremely important on Amazon according to Figure 3(d). This is intuitive since Amazonâ€™s topic labels are essentially product categories. In contrast, user information is more useful on GitHub than it is on Amazon. This can be explained by the following statistics: GitHub-Bio has 351 pairs of documents sharing the same user, out of which 288 (82%) have the same label; GitHub-AI has 348 pairs of repositories having the same user, among which 217 (62%) belong to the same class.
Embedding Dimension. Next, we investigate the performance of MetaCat with respect to its embedding dimension. Figure 5

Micro F1 Micro F1 Micro F1 Micro F1 Micro F1

60 ESim as embedding Mp2v as embedding
55 H2v as embedding No User No Tag
50 No Context Full
45
40
35
(a) GitHub-Bio
60 ESim as embedding Mp2v as embedding
55 H2v as embedding No User
50 NNoo TCaogntext Full
45
40
35
(a) GitHub-Bio

75 ESim as embedding

Mp2v as embedding

70

H2v as embedding No User

No Tag

65 No Context Full

60

55

50
(b) GitHub-AI

80 ESim as embedding Mp2v as embedding
75 HN2ovUasseer mbedding No Tag
70 No Context Full
65
60
55
(c) GitHub-Sec

70 ESim as embedding Mp2v as embedding
65 H2v as embedding No User
60 NNoo PCorondteuxctt Full
55
50
45
(d) Amazon

45 ESim as embedding Mp2v as embedding
40 H2v as embedding No User No Tag
35 No Context Full
30
25
20
(e) Twitter

Figure 3: Micro F1 scores of algorithms with different embedding modules.

70 ESim as embedding Mp2v as embedding
65 H2v as embedding No User
60 No Tag No Context Full
55
50
45
(b) GitHub-AI

70 ESim as embedding Mp2v as embedding
65 HN2ovUasseer mbedding No Tag
60 No Context Full
55
50
45
(c) GitHub-Sec

70 ESim as embedding Mp2v as embedding
65 H2v as embedding No User No Product
60 No Context Full
55
50
45
(d) Amazon

40 ESim as embedding Mp2v as embedding
35 H2v as embedding No User
30 NNoo TCaogntext Full
25
20
15
(e) Twitter

Figure 4: Macro F1 scores of algorithms with different embedding modules.

Macro F1 Macro F1 Macro F1 Macro F1 Macro F1

Micro F1 Macro F1 Micro F1 Macro F1

75 60 45 30 15
0

70

55

GitHub-Bio GitHub-Sec Twitter

GitHub-AI Amazon

100

200

300

Dimension

(a) Micro F1

40
25
10 0

GitHub-Bio GitHub-Sec Twitter

GitHub-AI Amazon

100

200

300

Dimension

(b) Macro F1

Figure 5: Performance of MetaCat with respect to the embedding dimension.

80

60

40

GitHub-Bio

GitHub-AI

GitHub-Sec

Amazon

20

Twitter

0 200 400 600 800 1000 #synthesized training samples per class

(a) Micro F1

70

60

50

GitHub-Bio

GitHub-AI

GitHub-Sec

Amazon

40

Twitter

30 0 200 400 600 800 1000 #synthesized training samples per class
(b) Macro F1

Figure 6: Performance of MetaCat with respect to the number of synthesized training samples.

Table 4: Most similar words to a given label in the embedding space of MetaCat.

Dataset GitHub-Bio
GitHub-AI Amazon Twitter

Label ğ‘™
Genetics
Structural Bioinformatics Entity Recognition Speech Synthesis Home & Kitchen Movies & TV Travel & Transport
Shop & Service

Top similar words ğ‘¤ mega, ezmap, igess, phenotypesimulator, multigems pywater, msisensor, knotty, breakpointsurveyor, cmv ner, ld, conll, entity, tags tacotron, lecture, tts, lj, spectrogram spinner, lettuce, salad, spinning, greens mafia, undercover, warren, depp, pacino baggage, airway, claim, fdny, jetblue keyfood, greenmarket, unsqgreenmarket, nailsbymii, nailart

reports Micro and Macro F1 scores with 10, 50, 100, 200 and 300dimensional embedding vectors. We can see that the performance drops when the dimension becomes too large. This observation is aligned with the results in [27, 33]. In fact, too small dimension cannot sufficiently capture the semantics, while too large dimension may lead to some overfitting problems, especially under weak supervision. Figure 5 shows that setting the dimension as 100 is reasonable in our experiments.

Cases. Table 4 shows the top-5 similar words to a given label in the embedding space of MetaCat. Here the similarity between word ğ‘¤ and label ğ‘™ is defined as cos(ğ’†ğ‘¤, ğ’†ğ‘™ ). Due to space limit, we demonstrate 8 categories from 4 datasets. We can find many strong topic indicators in Table 4. For example, in the GitHub domain, there are system/tool names (e.g., â€œpywaterâ€ and â€œtacotronâ€) and dataset names (e.g., â€œconllâ€ and â€œljâ€) related to the given category; in the Twitter domain, the top similar words mainly reflect the function of POIs (e.g., â€œairwayâ€, â€œjetblueâ€ and â€œunsqgreenmarketâ€).

4.5 Effect of Training Data Generation

We generate 100 training samples for each class in all previous

experiments. To investigate the effect of synthesized training data

amount, we plot the performance of MetaCat with 0, 20, 100, 500

and 1000 generated samples per class in Figure 6.

When |Dâˆ—| < 100, the F1 scores increase evidently with |Dâˆ—|.

ğ‘™

ğ‘™

For example, the average absolute improvement of Micro F1 is 7.3%

on the five datasets when comparing |Dâˆ—| = 100 with |Dâˆ—| = 0

ğ‘™

ğ‘™

(i.e., using â€œrealâ€ training data only). This observation validates our

claim that incorporating generated training data can boost classi-

fication performance. However, when the number of documents

becomes larger, the performance change is quite subtle. In fact, the

90

75

Micro F1 Micro F1

75
60
45 0

65

CNN Metapath2vec MetaCat
20 40 60 80 100 #labeled data per class
(a) GitHub-Sec

55
45 0

CNN Metapath2vec MetaCat
20 40 60 80 100 #labeled data per class
(b) Amazon

Embed Metadata? Generate Training Samples?

CNN

Metapath2vec

No

Yes

No

No

(c) Comparisons of the three approaches

MetaCat Yes Yes

Figure 7: Micro F1 scores of CNN, Metapath2vec and MetaCat with respect to the number of â€œrealâ€ training samples.

fluctuation is less than 1% in most cases after |Dâˆ—| â‰¥ 100. Moreover,
ğ‘™
generating too many data will make the training process inefficient.
In all, we believe having 100 to 500 synthesized training samples
per class will strike a good balance in our task.

4.6 Effect of â€œRealâ€ Training Data
According to Sections 4.4 and 4.5, we already know both embedding and generation modules are helpful when supervision is minimal. Now we examine their effects as â€œrealâ€ training data is increased. Three approaches are picked: CNN (does not embed metadata; does not generate training samples), Metapath2vec (embeds metadata; does not generate training samples) and MetaCat (embeds metadata; generates training samples). Figure 7 shows their performance with 10, 20, 50 and 100 â€œrealâ€ training samples per class on GitHubSec and Amazon.
Let us first compare MetaCat and Metapath2vec. When the amount of labeled data is relatively large, MetaCat only outperforms Metapath2vec by a small margin. However, if fewer labeled documents are provided, Metapath2vec exhibits more evident performance drop. For example, when |Dğ‘™ | = 10, the gap between MetaCat and Metapath2vec is 14.7% on GitHub-Sec; when |Dğ‘™ | = 100, the gap becomes 1.8%. This observation shows that training data generation is more powerful when supervision is weaker.
Then we proceed to the curves of CNN. Similar to Metapath2vec, its performance drops drastically when |Dğ‘™ | becomes small. However, there is always a large gap between CNN and MetaCat. When labeled training samples are sufficient, this gap is mainly attributed to the usage of metadata in embedding (because we already show that training data generation plays a limited role in this case); when there is less supervision, the gap becomes a composite effect of utilizing metadata and generating synthesized samples. Different from training data generation, no matter how many labeled documents are involved, exploiting metadata in embedding is always helpful.

5 RELATED WORK
Weakly Supervised Text Classification. Two forms of supervisions are commonly studied under weakly supervised text classification: (1) class-related keywords. For example, dataless classification

[1] only relies on descriptive keywords and has no requirement of any labeled document. Subsequent studies either extend topic models [2, 14, 16, 18] or exploit embedding techniques [15, 22] and contextualized representation learning models [21] to incorporate such keyword information. (2) a small set of labeled documents. For example, [32] jointly learns word/document/label representations; [23] generates pseudo documents to help the training process; [39] applies graph convolutional networks on the word-document cooccurrence graph. [24] and [36] further study weakly supervised hierarchical classification. However, these studies focus on text without metadata, which restricts their capacity in some practical scenarios. In contrast, MetaCat goes beyond plain text classification and utilizes multi-modal signals.
Text Classification with Metadata. Existing studies apply metadata to improve the performance of a text classifier, such as user and product information in sentiment analysis [31], author information in paper topic classification [26], and user biography data in tweet localization [41]. However, each of these frameworks focuses on one specific type of data, while we propose a general framework to deal with various data sources and metadata types. Kim et al. [11] study how to â€œinjectâ€ categorical metadata information into neural text classifiers. Their model can be applied in many cases such as review sentiment classification and paper acceptance classification. However, the model is designed under fully supervised settings and does not tackle label scarcity.
Embedding Learning of Heterogeneous Data. Heterogeneous Information Network (HIN) embedding is the most common technique to encode multi-modal signals. Many HIN embedding methods [5, 6, 27] leverage meta-path guided random walks to jointly model multiple interactions in a latent embedding space. One can refer to a recent tutorial [28] for more related studies. We have discussed the differences between HIN embedding and our generationguided embedding in Section 3.2. From the view of applications, several studies apply HIN embeddings into downstream classification tasks such as malware detection [9] and medical diagnosis [8]. Both [9] and [8], as well as experiments in [5, 6, 27], deal with structured data under fully supervised settings.
6 CONCLUSIONS AND FUTURE WORK
We presented MetaCat, a framework to categorize text with metadata under minimal supervision. To tackle the challenges of data heterogeneity and label scarcity, we propose a generation-guided embedding module and a training data generation module. Both modules are derived from a generative process characterizing the relationships between text and metadata. We demonstrate the effectiveness of MetaCat on five datasets. Moreover, we validate the design of our framework by showing (1) the superiority of our embedding module towards meta-path based HIN embedding methods and (2) the significant contribution of our generation module especially when the amount of supervision is very limited.
For future work, first, it is interesting to study how to effectively integrate different forms of supervision (e.g., annotated documents and class-related keywords) to further boost the performance. Second, we would like to explore the possibility of coupling heterogeneous signal embedding and graph neural networks during the classification process.

ACKNOWLEDGMENTS
We thank Sha Li for useful discussions. The research was sponsored
in part by DARPA under Agreements No. W911NF-17-C-0099 and
FA8750-19-2-1004, National Science Foundation IIS 16-18481, IIS 17-
04532, and IIS-17-41317, and DTRA HDTRA11810026. Any opinions,
findings, and conclusions or recommendations expressed in this
document are those of the author(s) and should not be interpreted
as the views of any U.S. Government. The U.S. Government is
authorized to reproduce and distribute reprints for Government
purposes notwithstanding any copyright notation hereon. We thank
anonymous reviewers for valuable and insightful feedback.
REFERENCES
[1] Ming-Wei Chang, Lev-Arie Ratinov, Dan Roth, and Vivek Srikumar. 2008. Importance of Semantic Representation: Dataless Classification.. In AAAIâ€™08. 830â€“835.
[2] Xingyuan Chen, Yunqing Xia, Peng Jin, and John Carroll. 2015. Dataless text classification with descriptive LDA. In AAAIâ€™15.
[3] Zhiyuan Cheng, James Caverlee, and Kyumin Lee. 2010. You are where you tweet: a content-based approach to geo-locating twitter users. In CIKMâ€™10. 759â€“768.
[4] Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019. BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding. In NAACL-HLTâ€™19. 4171â€“4186.
[5] Yuxiao Dong, Nitesh V Chawla, and Ananthram Swami. 2017. metapath2vec: Scalable representation learning for heterogeneous networks. In KDDâ€™17. 135â€“ 144.
[6] Tao-yang Fu, Wang-Chien Lee, and Zhen Lei. 2017. Hin2vec: Explore meta-paths in heterogeneous information networks for representation learning. In CIKMâ€™17. 1797â€“1806.
[7] Siddharth Gopal and Yiming Yang. 2014. Von mises-fisher clustering models. In ICMLâ€™14. 154â€“162.
[8] Anahita Hosseini, Ting Chen, Wenjun Wu, Yizhou Sun, and Majid Sarrafzadeh. 2018. HeteroMed: Heterogeneous Information Network for Medical Diagnosis. In CIKMâ€™18. 763â€“772.
[9] Shifu Hou, Yanfang Ye, Yangqiu Song, and Melih Abdulhayoglu. 2017. Hindroid: An intelligent android malware detection system based on structured heterogeneous information network. In KDDâ€™17. 1507â€“1515.
[10] Rie Johnson and Tong Zhang. 2017. Deep pyramid convolutional neural networks for text categorization. In ACLâ€™17. 562â€“570.
[11] Jihyeok Kim, Reinald Kim Amplayo, Kyungjae Lee, Sua Sung, Minji Seo, and Seung-won Hwang. 2019. Categorical Metadata Representation for Customized Text Classification. TACL 7 (2019), 201â€“215.
[12] Yoon Kim. 2014. Convolutional Neural Networks for Sentence Classification. In EMNLPâ€™14. 1746â€“1751.
[13] Omer Levy, Yoav Goldberg, and Ido Dagan. 2015. Improving distributional similarity with lessons learned from word embeddings. TACL 3 (2015), 211â€“225.
[14] Chenliang Li, Jian Xing, Aixin Sun, and Zongyang Ma. 2016. Effective document labeling with very few seed words: A topic model approach. In CIKMâ€™16. 85â€“94.
[15] Keqian Li, Hanwen Zha, Yu Su, and Xifeng Yan. 2018. Unsupervised neural categorization for scientific publications. In SDMâ€™18. 37â€“45.
[16] Ximing Li, Changchun Li, Jinjin Chi, Jihong Ouyang, and Chenliang Li. 2018. Dataless text classification: A topic modeling approach with document manifold. In CIKMâ€™18. 973â€“982.
[17] Jingzhou Liu, Wei-Cheng Chang, Yuexin Wu, and Yiming Yang. 2017. Deep learning for extreme multi-label text classification. In SIGIRâ€™17. 115â€“124.
[18] Yue Lu and Chengxiang Zhai. 2008. Opinion integration through semi-supervised topic modeling. In WWWâ€™08. 121â€“130.

[19] Kanti V Mardia and Peter E Jupp. 2009. Directional statistics. Vol. 494. John Wiley & Sons.
[20] Julian McAuley and Jure Leskovec. 2013. Hidden factors and hidden topics: understanding rating dimensions with review text. In RecSysâ€™13. 165â€“172.
[21] Dheeraj Mekala and Jingbo Shang. 2020. Contextualized Weak Supervision for Text Classification.. In ACLâ€™20.
[22] Yu Meng, Jiaxin Huang, Guangyuan Wang, Zihan Wang, Chao Zhang, Yu Zhang, and Jiawei Han. 2020. Discriminative Topic Mining via Category-Name Guided Text Embedding. In WWWâ€™20. 2121â€“2132.
[23] Yu Meng, Jiaming Shen, Chao Zhang, and Jiawei Han. 2018. Weakly-supervised neural text classification. In CIKMâ€™18. 983â€“992.
[24] Yu Meng, Jiaming Shen, Chao Zhang, and Jiawei Han. 2019. Weakly-supervised hierarchical text classification. In AAAIâ€™19. 6826â€“6833.
[25] Tomas Mikolov, Ilya Sutskever, Kai Chen, Greg S Corrado, and Jeff Dean. 2013. Distributed representations of words and phrases and their compositionality. In NIPSâ€™13. 3111â€“3119.
[26] Michal Rosen-Zvi, Thomas Griffiths, Mark Steyvers, and Padhraic Smyth. 2004. The author-topic model for authors and documents. In UAIâ€™04. 487â€“494.
[27] Jingbo Shang, Meng Qu, Jialu Liu, Lance M Kaplan, Jiawei Han, and Jian Peng. 2016. Meta-path guided embedding for similarity search in large-scale heterogeneous information networks. arXiv preprint arXiv:1610.09769 (2016).
[28] Chuan Shi and Philip S Yu. 2019. Recent Developments of Deep Heterogeneous Information Network Analysis. In CIKMâ€™19. 2973â€“2974.
[29] Chi Sun, Xipeng Qiu, Yige Xu, and Xuanjing Huang. 2019. How to fine-tune BERT for text classification?. In CCLâ€™19. 194â€“206.
[30] Yizhou Sun, Jiawei Han, Xifeng Yan, Philip S Yu, and Tianyi Wu. 2011. Pathsim: Meta path-based top-k similarity search in heterogeneous information networks. PVLDB 4, 11 (2011), 992â€“1003.
[31] Duyu Tang, Bing Qin, and Ting Liu. 2015. Learning semantic representations of users and products for document level sentiment classification. In ACLâ€™15. 1014â€“1023.
[32] Jian Tang, Meng Qu, and Qiaozhu Mei. 2015. Pte: Predictive text embedding through large-scale heterogeneous text networks. In KDDâ€™15. 1165â€“1174.
[33] Jian Tang, Meng Qu, Mingzhe Wang, Ming Zhang, Jun Yan, and Qiaozhu Mei. 2015. Line: Large-scale information network embedding. In WWWâ€™15. 1067â€“1077.
[34] Chenglong Wang, Feijun Jiang, and Hongxia Yang. 2017. A hybrid framework for text modeling with convolutional rnn. In KDDâ€™17. 2061â€“2069.
[35] Ke Wang and Xiaojun Wan. 2018. Sentiment analysis of peer review texts for scholarly papers. In SIGIRâ€™18. 175â€“184.
[36] Huiru Xiao, Xin Liu, and Yangqiu Song. 2019. Efficient Path Prediction for SemiSupervised and Weakly Supervised Hierarchical Text Classification. In WWWâ€™19. 3370â€“3376.
[37] Chao Xing, Dong Wang, Chao Liu, and Yiye Lin. 2015. Normalized word embedding and orthogonal transform for bilingual word translation. In NAACL-HLTâ€™15. 1006â€“1011.
[38] Zichao Yang, Diyi Yang, Chris Dyer, Xiaodong He, Alex Smola, and Eduard Hovy. 2016. Hierarchical attention networks for document classification. In NAACLâ€™16. 1480â€“1489.
[39] Liang Yao, Chengsheng Mao, and Yuan Luo. 2019. Graph convolutional networks for text classification. In AAAIâ€™19. 7370â€“7377.
[40] Chao Zhang, Keyang Zhang, Quan Yuan, Fangbo Tao, Luming Zhang, Tim Hanratty, and Jiawei Han. 2017. React: Online multimodal embedding for recencyaware spatiotemporal activity modeling. In SIGIRâ€™17. 245â€“254.
[41] Yu Zhang, Wei Wei, Binxuan Huang, Kathleen M Carley, and Yan Zhang. 2017. RATE: Overcoming Noise and Sparsity of Textual Features in Real-Time Location Estimation. In CIKMâ€™17. 2423â€“2426.
[42] Yu Zhang, Frank F. Xu, Sha Li, Yu Meng, Xuan Wang, Qi Li, and Jiawei Han. 2019. HiGitClass: Keyword-Driven Hierarchical Classification of GitHub Repositories. In ICDMâ€™19. 876â€“885.
[43] Chunting Zhou, Chonglin Sun, Zhiyuan Liu, and Francis Lau. 2015. A C-LSTM neural network for text classification. arXiv preprint arXiv:1511.08630 (2015).

