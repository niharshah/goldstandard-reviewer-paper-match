Conï¬‚uent Vessel Trees with Accurate Bifurcations
Zhongwen Zhang1 Dmitrii Marin1,2 Maria Drangova3 Yuri Boykov1,2
1University of Waterloo, Canada 2Vector Research Institute, Canada 3Robarts Research, Canada

arXiv:2103.14268v1 [cs.CV] 26 Mar 2021

Abstract
We are interested in unsupervised reconstruction of complex near-capillary vasculature with thousands of bifurcations where supervision and learning are infeasible. Unsupervised methods can use many structural constraints, e.g. topology, geometry, physics. Common techniques use variants of MST on geodesic tubular graphs minimizing symmetric pairwise costs, i.e. distances. We show limitations of such standard undirected tubular graphs producing typical errors at bifurcations where ï¬‚ow â€œdirectednessâ€ is critical. We introduce a new general concept of conï¬‚uence for continuous oriented curves forming vessel trees and show how to enforce it on discrete tubular graphs. While conï¬‚uence is a high-order property, we present an eï¬ƒcient practical algorithm for reconstructing conï¬‚uent vessel trees using minimum arborescence on a directed graph enforcing conï¬‚uence via simple ï¬‚ow-extrapolating arc construction. Empirical tests on large near-capillary sub-voxel vasculature volumes demonstrate signiï¬cantly improved reconstruction accuracy at bifurcations. Our code has also been made publicly available 1.
1. Introduction
This paper is focused on unsupervised vessel tree estimation in large volumes containing numerous nearcapillary vessels and thousands of bifurcations, see Figs. 1, 10. Around 80% of the vessels in such data have sub-voxel diameter resulting in partial volume eï¬€ects such as contrast loss and gaps. Besides the topological accuracy of trees reconstructed from such challenging imagery, we are particularly interested in the accurate estimation of bifurcations due to their importance in biomedical and pharmaceutical research.
1.1. Unsupervised vasculature estimation methods
Unsupervised vessel tree estimation methods for complex high-resolution volumetric vasculature data
1https://vision.cs.uwaterloo.ca/code.

(a) synthetic raw data with (b) geodesic graph two trees (blue & green) MST [13, 32, 28,
23]

(c) conï¬‚uent tree reconstruction

Figure 1: Synthetic example: (a) raw 3D data with blue & green reconstructed trees, see also zoom-ins (b,c). The blue tree (a,b) is an MST on a geodesic tubular graph. The green tree (a,c), is a minimum arborescence on a directed conï¬‚uent tubular graph, see Sec. 3.

combine low-level vessel ï¬ltering and algorithms for computing global tree structures based on constraints from anatomy, geometry, physics, etc. Below we review the most relevant standard methodologies.
Low-level vessel estimation: Anisotropy of tubular structures is exploited by standard vessel ï¬ltering techniques, e.g. Frangi et al. [9]. Combined with nonmaximum suppression, local tubularity ï¬lters provide estimates for vessel centerline points and tangents, see Fig. 2(a). Technically, elongated structures can be detected using intensity Hessian spectrum [9], optimally oriented ï¬‚ux models [18, 28], steerable ï¬lters [10], path operators [22] or other anisotropic models. Dense local vessel detections can be denoised using curvature regularization [24, 20]. Prior knowledge about divergence or convergence of the vessel tree (arteries vs veins) can also be exploited to estimate an oriented ï¬‚ow pattern [34], see Fig. 2(b).
Thinning: One standard approach to vessel topology estimation is via medial axis [26]. This assumes known vessel segmentation (volumetric mask) [21], which can be computed only for relatively thick vessels. Well-formulated segmentation of thin structures requires Gaussian- or min-curvature surface regularization that has no known practical algorithms. Segmen-

(a) Frangi ï¬ltering [9]

(b) oriented ï¬‚ow pattern [34]

Figure 2: Low-level vessel estimation: True centerline is black. Blue voxels in (a) are local maxima of some tubularity measure [9, 18, 28, 10] in the direction orthogonal to the estimated centerline tangents (red). Regularization [24, 20] can estimate subpixel centerline points (b) and oriented tangents [34] (red ï¬‚ow ï¬eld).

(a) geodesic tubular graph

(b) MST

Figure 3: Global vessel tree reconstruction: (a) geodesic tubular graph is based on low-level estimates in Fig. 2. Graph edges represent distances, geodesics, or other symmetric (undirected) properties. MST reconstruction quality (b) depends on the graph construction (nodes, neighborhoods, edge weights).

tation is particularly unrealistic for sub-voxel vessels.
Geodesics and shortest paths: Geodesics [5, 2] and shortest paths [7] are often used for AB-interactive reconstruction of vessels between two speciï¬ed points. A vessel is represented by the shortest path with respect to some anisotropic continuous (Riemannian) or discrete (graph) metric based on a local tubularity measure. Interestingly, the minimum path in an â€œelevatedâ€ search space combining spatial locations and radii can simultaneously estimate the vesselâ€™s centerline and diameter, implicitly representing vessel segmentation [19, 1]. Unsupervised methods widely use geodesics as their building blocks.
Spanning trees: The standard graph concept of a minimum spanning tree (MST) is well suited for unsupervised reconstruction of large trees with unknown complex topology [13, 32, 28, 23]. MST is closely related to the shortest paths and geodesics since its optimality is deï¬ned with respect to its length. Like shortest paths, globally optimal MST can be computed very eï¬ƒciently. In contrast to the shortest paths, MST can reconstruct arbitrarily complex trees without user interaction.
The quality of MST vessel tree reconstruction depends on the underlying graph construction, see Figs. 3 and 13(a). Graphs designed for reconstructing thin tubular structures as their spanning tree (or sub-tree) are often called tubular graphs. Typically, the nodes are â€œanchorâ€ points generated by low-level vessel estimators, e.g. see Fig. 2. Such anchors represent sparse [29] or semi-dense [20] samples from the estimated tree structure that may be corrupted by noise and outliers. Pairwise edges on a tubular graph typically represent distances or geodesics between the nodes, as in AB-

interactive methods discussed earlier. Such graphs are called geodesic tubular graphs, see Fig. 4.
There are numerous variants of tubular graph constructions designed to represent various thin structures as MST [13, 32, 28, 23] or shortest path trees [25]. There are also interesting and useful extensions of MST addressing tubular graph outliers, e.g. k-MST [30] and integer programming technique in [29]. Such approaches are more powerful as they seek minimum subtrees that can automatically exclude outliers. However, the corresponding optimization problems are NP-hard and require approximations. Such methods are expensive compared to the low-order polynomial complexity of MST. They are not practical for dense reconstruction problems in high-resolution vasculature volumes.
1.2. Motivation and contributions
We are interested in unsupervised reconstruction of large complex trees from vasculature volumes resolving near-capillary details. Common geodesic approaches can not represent asymmetric smoothness at bifurcations, which have forms sensitive to ï¬‚ow orientation. Hence, standard methods produce vessel tree reconstructions with signiï¬cant bifurcation artifacts, see Figs. 1(b), 3(b) and 13(a). We deï¬ne a general geometric property for oriented vessels, conï¬‚uence, which is missing in prior art, and propose a practical graphbased reconstruction method enforcing it. The reconstructed conï¬‚uent vessel trees have signiï¬cantly better bifurcation accuracy. Our contributions are detailed below.
â€¢ We introduce conï¬‚uence as a geometric property for overlapping oriented smooth curves in R3, e.g.

image from [30]
(a) sparse graph

k=2

k=3

k=6

(b) semi-dense geodesic tubular graphs with diï¬€erent size NN systems

Figure 4: Examples of standard geodesic tubular graphs for vascular image data: A graph from [30] in (a) uses (purple) nodes connected by undirected edges corresponding to shortest paths (geodesics) w.r.t. tubularity-based Riemanninian metric. Alternatively, (b) shows graphs where (blue) nodes correspond to densely-sampled voxels along the vessels [34]. Here the edges correspond to nearest neighbors (KNN) weighted by length of some spline interpolation. In both cases (a) and (b), near- or sub-voxel vessels have sparsely sampled bifurcations.

representing blood-ï¬‚ow trajectories2. It is like â€œcodiï¬€erentiabilityâ€ or â€œco-continuityâ€. We deï¬ne conï¬‚uent vessel trees formed by overlapping oriented curves.
â€¢ We extend conï¬‚uence to discrete paths and trees on directed tubular graphs where directed arcs/edges represent continuous oriented arcs/curves in R3. We propose a simple ï¬‚ow-extrapolating circular arc construction that guarantees Îµ-conï¬‚uence, which approximates conï¬‚uence. Our conï¬‚uence constraint implies directed tubular graph with asymmetric edge weights, which is in contrast to standard undirected geodesic tubular graphs [16, 13, 32, 28, 23, 30, 20, 29, 34].
â€¢ We present an eï¬ƒcient practical algorithm for reconstructing conï¬‚uent vessel trees. It uses minimum arborescence [6, 27] on our directed conï¬‚uent tubular graph construction.
â€¢ Our experiments on synthetic and real data conï¬rm that conï¬‚uent tree reconstruction signiï¬cantly improves bifurcation accuracy. We demonstrate qualitative and quantitative improvements via standard and new accuracy measures 3 evaluating tree structure, bifurcation localization, and bifurcation angles.
Our concept of conï¬‚uent trees is general and our speciï¬c algorithm can be modiï¬ed or extended in many ways, some of which are discussed in Sec. 3. To explicitly address outliers, minimum arborescence on our conï¬‚uent tubular graph can be replaced by optimal sub-tree algorithms [30, 29]4 or explicit outlier de-
2Conï¬‚uence is known in other contexts, e.g. rail tracks [15]. 3For our dataset and implementation of evaluation metrics discussed in this paper see https://vision.cs.uwaterloo.ca/data. 4IP solver in [29] uses minimum arborescence as a subroutine.

Î² p
Î± (a) conï¬‚uence at point p

Î²
Î± (b) conï¬‚uent curves

Figure 5: Conï¬‚uence for oriented curves Î± and Î².

tection [20], but these approximation algorithms address NP-hard problems and maybe too expensive for large semi-dense tubular graphs we study in this work. While outlier detection is relevant, this work is not focused on this problem.
2. Conï¬‚uence of Oriented Curves
This section introduces geometrically-motivated concept of smoothness for objects containing multiple oriented curves, such as vessel trees. We deï¬ne conï¬‚uence as follows.
Definition 1 (conï¬‚uence at a point). Two diï¬€erentiable oriented curves Î±(t) and Î²(Ï„ ) are called conï¬‚uent at a shared point p if for some k > 0
Î± (tp) = k Î² (Ï„p) where
tp and Ï„p are s.t. Î±(tp) = Î²(Ï„p) = p, see Fig. 5(a).
We will call two oriented curves conï¬‚uent if they are conï¬‚uent at all points they share, see Fig. 5(b).
Our concept of conï¬‚uence is closely related to the geometric G1-continuity [4, 8]. A curve Î± is called G1-

(a) âˆ (cË˜p1q, cË˜q0âˆ—) â‰¤ Îµ short conï¬‚uent arc cË˜pq

(b) âˆ (cË˜q1p, cË˜p0âˆ—) â‰¤ Îµ long conï¬‚uent arc cË˜qp

(c) âˆ (cË˜q1p, cË˜p0âˆ—) â‰¤ Îµ non-conï¬‚uent arc cË˜qp

Figure 6: Examples of directed ï¬‚ow-extrapolating circular arcs: (a) ï¬‚ow cË˜p1q extrapolated by conï¬‚uent arc cË˜pq from p to q is consistent with the local ï¬‚ow estimate Â¯lq = cË˜q0âˆ— at point q as the angle between two vectors is small. Flow extrapolation from q to p in (b) requires another circular arc cË˜qp that belongs to a diï¬€erent circle deï¬ned by tangent Â¯lq. Two arcs cË˜pq and cË˜qp are not even co-planar if tangents Â¯lp and Â¯lq are not. The extrapolated ï¬‚ow cË˜q1p is also consistent with the local ï¬‚ow estimate Â¯lp = cË˜p0âˆ— at p, so that the reverse arc cË˜qp in (b) is conï¬‚uent as well. In (c) the local ï¬‚ow estimate Â¯lp at p is ï¬‚ipped and arc cË˜qp becomes non-conï¬‚uent since the angle between cË˜q1p and Â¯lp = cË˜p0âˆ— is large. Note that arc cË˜pq in (c) diï¬€ers from (a) but it must be non-conï¬‚uent as well, see Theorem 1.

continuous if at any point on the curve the slope orientation is continuous. Incidentally, the diï¬€erentiability classes Ck are too restrictive as a G1-continuous curve can easily be not C1 due to the curve parameterization. Note that G1-continuity is only deï¬ned for a single curve while our conï¬‚uence extends it for a pair of curves and can be seen as â€œco-G1-continuityâ€.
Our concept of conï¬‚uence allows deï¬ning arbitrarily complex (continuous) conï¬‚uent vessel trees. Such trees are formed by multiple oriented curves representing motion trajectories of blood particles from the common root to an arbitrary number of leaves where each pair of curves must be conï¬‚uent. Fig. 5(b) shows a simple example of a tree formed by two conï¬‚uent curves with one bifurcation, which can be formally deï¬ned.
3. Conï¬‚uent Tubular Graphs
Our discrete approach to reconstructing conï¬‚uent vessel trees is based on eï¬ƒcient algorithms for directed graphs. Our â€œtubularâ€ graph nodes correspond to a ï¬nite set of detected vessel points. We use discrete representation of oriented vessels as paths along directed edges or directed arcs (p, q) connecting the graph nodes. Each arc (p, q) on our tubular graph represents an oriented continuous â€œï¬‚ow-extrapolatingâ€ curve in R3 from p to q. Such curves could be obtained from physical models based on ï¬‚uid dynamics. For simplicity, this paper is focused on oriented circular arcs, see Sec. 3.1, motivated as the lowest-order polynomial splines capable of enforcing G1-continuity and conï¬‚uence. In general, our conï¬‚uent tubular graph construction can use

higher-order ï¬‚ow-extrapolation models, e.g. cubic Hermite splines that are common in computer graphics and geometric modeling of motion trajectories.
By using circular arcs as ï¬‚ow-extrapolating curves, we introduce some ambiguity with â€œarcsâ€ as the standard term for graph edges. However, this should not create confusion since there is a one-to-one relation between directed arcs on our tubular graph and the corresponding (circular) oriented arcs in R3. Note that both interpretations are oriented/directed. In all technically formal sentences, continuous or discrete interpretation of the â€œarcâ€ is clear from the context. In more informal settings, both interpretations are often equally valid.
The rest of this Section is as follows. Oriented ï¬‚ow-extrapolating circular arcs between tubular graph nodes are introduced in Sec. 3.1 where Îµ-conï¬‚uence constraint is deï¬ned in the context of such arcs. We also deï¬ne directed arc weights to represent the conï¬‚uence constraint and the local costs of sending ï¬‚ow along these arcs. Geometric properties of conï¬‚uent circular arcs are discussed in Sec. 3.2. The algorithm estimating conï¬‚uent vessel trees via minimum arborescence on our directed tubular graph is presented in Sec. 3.3.
3.1. Conï¬‚uent ï¬‚ow-extrapolating arcs
Formally, tubular graph G = V, A is based on a set of nodes/points V embedded in R3 representing semidensely sampled centerlines of a tubular structure. A âŠ† V 2 is a set of directed arcs. For our tubular graph construction, each directed arc (p, q) âˆˆ A represents some continuous oriented curve in R3 modelling ï¬‚ow-

extrapolation from point p to point q, see Fig. 6. As discussed earlier, this paper is focused on oriented circular arcs as the simplest geometric model that can represent conï¬‚uent vessels, even though higher-order geometric splines or physics-motivated curves are possible. Our speciï¬c construction uses ï¬‚ow-extrapolating circular arcs based on a set of unit vectors LÂ¯ = {Â¯lp}pâˆˆV âŠ‚ S2 representing ï¬‚ow direction estimates at the nodes, see Fig. 2(b). Oriented circular arc cË˜pq is ï¬t into starting point p, its ï¬‚ow orientation estimate Â¯lp, and the ending point q, see Fig. 6. Formally, curve cË˜pq corresponds to a diï¬€erentiable function

cË˜pq : [0, 1] â†’ R3

traversing points on a circular arc in the plane spanned by p, q, and vector Â¯lp so that

cË˜ (0) = p , cË˜ (1) = q , cË˜pq(0) = Â¯l (1)

pq

pq

cË˜pq (0)

p

where derivative cË˜pq(s) gives an oriented tangent. For shortness, we deï¬ne (oriented) unit tangents
at the beginning and the end points of any ï¬‚owextrapolating arc cË˜ as

cË˜0 := cË˜ (0)

,

cË˜1 :=

cË˜ (1) .

(2)

cË˜ (0)

cË˜ (1)

The deï¬nition of arc cË˜pq in (1) implies cË˜p0q â‰¡ Â¯lp so that tangent cË˜p0q is the same for any arc starting at given point p regardless of its end point q. Thus,

cË˜p0âˆ— â‰¡ Â¯lp

(3)

where the star âˆ— represents an arbitrary end point. On the other hand, tangent cË˜p1q at the end point q depends on the arcâ€™s starting point p. That is, generally,

âˆ (cË˜p1q, cË˜r1q) â‰¡ 0 if p = r.

Îµ-Conï¬‚uence Constraint: To constrain our tubular graph so that all feasible vessel trees are conï¬‚uent, it suï¬ƒces to enforce conï¬‚uence of the arcs at the nodes where they meet. However, our simple ï¬‚owextrapolating circular arcs (1) can not be used to enforce the exact conï¬‚uence. We use some threshold Îµ to introduce a relaxed version of conï¬‚uence in Deï¬nition 1 for an arbitrary pair of adjacent arcs cË˜pq, cË˜qr connecting points p, q and r
âˆ (cË˜p1q, cË˜q0r) â‰¤ Îµ.
In general, this is a high-order (triple clique) constraint. But, property (3) of our ï¬‚ow-extrapolating arc construction shows that the end point of the second arc cË˜qr is irrelevant. Indeed,
âˆ (cË˜p1q, cË˜q0r) = âˆ (cË˜p1q, Â¯lq) â‰¡ âˆ (cË˜p1q, cË˜q0âˆ—)

implying that our speciï¬c tubular graph construction allows to express conï¬‚uence as a pairwise constraint

âˆ (cË˜p1q, cË˜q0âˆ—) â‰¤ Îµ

(4)

for any pair of points p, q. In essence, this becomes a constraint for our ï¬‚ow extrapolating arcs cË˜pq that can be called conï¬‚uent if âˆ (cË˜p1q, Â¯lq) â‰¤ Îµ, see Fig. 6.
To enforce Îµ-conï¬‚uence constraint, our tubular graph can simply drop all non-conï¬‚uent arcs. Thus, any directed vessel tree on our graph will be conï¬‚uent by construction. This paper explores the simplest approach to reconstructing conï¬‚uent vessel trees as the minimum arborescence on our directed tubular graph. In this case, instead of dropping non-conï¬‚uent arcs, one can incorporate Îµ-conï¬‚uence constraint directly into the cost of the corresponding directed graph arcs

wpq := length(cË˜pq) if âˆ (cË˜p1q, cË˜q0âˆ—) â‰¤ Îµ (5)

âˆ

otherwise.

The reverse edge on our tubular graph has diï¬€erent weight wqp = wpq because it corresponds to a diï¬€erent ï¬‚ow extrapolating arc cË˜qp that has a diï¬€erent length, see Fig. 6(b). As an extension, our approach also allows â€œelasticâ€ arc weights by adding integral of arcâ€™s curvature to its length in (5). It is also possible to impose soft penalties for the discrepancy between the extrapolated ï¬‚ow cË˜p1q and ï¬‚ow estimate cË˜q0âˆ— â‰¡ lq in (5) based on physical, physiological, or other principles.
Note that higher-order (non-circular) extrapolation arcs cË˜pq can be constructed to ï¬t the ï¬‚ow orientation estimates at both ends exactly, implying an exactly conï¬‚uent graph. However, some non-trivial physiological constraints have to be imposed on the smoothness/curvature of such (non-circular) conï¬‚uent arcs which should result in very long curves in cases like Fig. 6(c). Thus, the conï¬‚uence constraint will manifest itself similarly to the second line in (5).

3.2. Conï¬‚uence and co-circularity

Speciï¬cally for oriented circular arcs, conï¬‚uence implies several interesting properties and can be juxtaposed with the standard concept of co-circularity [24]. Assume some circular ï¬‚ow-extrapolating arc cË˜pq and its reverse cË˜qp deï¬ned by two oriented tangents Â¯lp, Â¯lq, see Sec. 3.1 and Fig. 6(a,b).
Property 1. The angle between cË˜p1q and Â¯lq is equal to the angle between cË˜q1p and Â¯lp. That is,

âˆ (cË˜p1q, cË˜q0p) â‰¡ âˆ (cË˜q1p, cË˜p0q).

(6)

While not immediately obvious, particularly in 3D, this property is not diï¬ƒcult to prove, see Appendix A. Identity (6) implies the following.

vessel tree reconstruction using
undirected Geodesic Tubular Graph (standard)

geodesic arcs

GridMST

vessel tree reconstructions using
directed Conï¬‚uent Tubular Graph (our)

conï¬‚uent arcs

MArb

(a) MST (blue) for Geodesic Tubular Graph (yellow) [16, 30, 34] (b) Min Arborescence (green) for Conï¬‚uent Tubular Graph (yellow)
Figure 7: Typical tree reconstruction examples for standard geodesic (a) and our conï¬‚uent (b) tubular graphs. Arc weights are represented via thickness (yellow). The data is a (representative) crop with near-capillary vessels at a periphery of large volumes, e.g. Fig. 1, 10. Sub-voxel vessels have bifurcations sparsely sampled by tubular graph nodes, as in Fig. 4. MST (blue) on geodesic graph â€œshort-cutsâ€ most bifurcations. Minimum arborescence (green) on a directed tubular graph with conï¬‚uent arcs (b), see Sec. 3.1, reconstructs ï¬‚ow-consistent bifurcations.

Theorem 1. For circular ï¬‚ow extrapolating arcs, cË˜pq is conï¬‚uent iï¬€ the reverse arc cË˜qp is conï¬‚uent.

This theorem shows that conï¬‚uence of cË˜pq and cË˜qp in Fig. 6(a,b) is not a coincidence. However, in general, such symmetry does not hold for non-circular ï¬‚owextrapolating arcs (higher order polynomial curves, etc). Also, Theorem 1 does not imply â€œundirectednessâ€ of our conï¬‚uent tubular graph construction using simple circular arcs. As follows from (5), wpq = wqp since the reverse arcs cË˜pq and cË˜qp have diï¬€erent lengths regardless of conï¬‚uence, see Fig. 6(a,b).
Interestingly, our conï¬‚uence constraint in case of circular oriented arcs can be related to an â€œorientedâ€ generalization of co-circularity that was originally deï¬ned in [24] for 2D curves. In Rn co-circularity constraint can be deï¬ned for two unoriented tangent lines lp and lq at points p and q in a way similar to our deï¬nition of conï¬‚uence for cË˜pq that is based on oriented tangents Â¯lp and Â¯lq. Assume unoriented circle cpq uniquely deï¬ned in Rn by a pair of points p, q and tangent lp at the ï¬rst point. If we use cx to denote an unoriented unit tangent of circle c at any given point x, then circle cpq is uniquely deï¬ned by three conditions

cpq : p âˆˆ cpq, q âˆˆ cpq, cppq = lp.

(7)

In general, circle cqp is diï¬€erent as it is deï¬ned by tangent lq at point q, that is cqqp = lq. Then, co-circularity
constraint for lp and lq can be deï¬ned as

âˆ 

(c

q pq

,

cqqp

)

â‰¡

âˆ (cqpp, cppq)

â‰¤

(8)

where âˆ (Â·, Â·) is the angle between two lines in contrast to the angle between vectors in the similar identity (6).

The diï¬€erence between conï¬‚uence for Â¯lp, Â¯lq and cocircularity for lp, lq can be illustrated by the examples in Fig. 6. Note that unoriented versions of Â¯lp, Â¯lq are identical in all three examples (a,b,c) as they do not depend of the ï¬‚ip of orientation in (c). Thus, they are equally co-circular in (a,b,c). At the same time, oriented tangents are conï¬‚uent in (a,b) while ï¬‚ipping orientation for Â¯lp results in non-conï¬‚uence in (c). The properties discussed above imply that conï¬‚uence can be seen as oriented generalization of co-circularity [24].
Property 2. Conï¬‚uence of oriented circular arcs cË˜pq or cË˜qp, which are deï¬ned by oriented tangents Â¯lp, Â¯lq, implies co-circularity of the corresponding unoriented tangents lp, lq, but not the other way around.
Note that co-circularity constraint for unoriented circular arcs along a path on a tubular graph can enforce G1-smoothness within a single vessel branch. But, unoriented co-circularity enforces smoothness indiscriminately in all directions from a bifurcation point without resolving conï¬‚icts between multiple branches. This leads to artifacts observed on geodesic tubular graphs, see Fig. 13(a). In contrast, the conï¬‚uence constraint discriminates orientations of branches when enforcing smoothness at bifurcations, see Fig. 13(b).
3.3. Conï¬‚uent tree reconstruction algorithm
Our Conï¬‚uent Tree Reconstruction Algorithm 1 is discussed below. It inputs raw volumetric data with a marked root of the tree. The algorithm has four steps. First, it runs a subroutine that estimates a set of points on the tree centerline V and oriented ï¬‚ow pattern at these points LÂ¯. We use a standard vector ï¬eld

Algorithm 1 Conï¬‚uent Tree Reconstruction Require: Raw volumetric data and root location
1: Estimate a set of centerline points V and directed ï¬‚ow estimates LÂ¯ = {Â¯lp|p âˆˆ V }.
2: Build a set of oriented arcs A âŠ† V Ã— V , Sec. 3.1 3: Build a conï¬‚uent tubular graph G by computing
weights wpq for (p, q) âˆˆ A using (5). 4: Return the Minimum Arborescence of G.
estimation method [34] based on non-negative divergence constraint and regularization over the voxel-grid neighborhood. Since 80% of our large vasculature volumes are near-capillary vessels, the weak sub-voxel signal often results in missing data points and grid-based regularization fails to produce consistent ï¬‚ow orientations, particularly at the tree periphery. We modiï¬ed [34] by (anisotropically) enlarging their regularization neighborhood, see Appendix B, improving the quality of ï¬‚ow estimates LÂ¯ that helps to reconstruct conï¬‚uent vessel trees.
Second, we build a set of oriented arcs between the points in V that correspond to directed edges on our tubular graph G. Our conï¬‚uence constraint works well even with a complete graph A = V Ã— V . But, for eï¬ƒciency, we restrict the neighborhood to K nearest neighbors (KNN). The running time is O(K|V | log |V |) with k-d trees.
The last two steps compute a directed weight wpq for all arcs (p, q) âˆˆ A as described in Sec. 3.1, and invoke a standard minimum arborescence algorithm that has complexity O(|A| + |V | log |V |) [11]. In practice, the overall running time of our method for vessel tree reconstruction is dominated by the centerline localization and ï¬‚ow pattern estimation in the ï¬rst step.
4. Experimental results
We use two baselines which we call NMS-MST and GridMST. NMS-MST uses the Frangi method [9] along with Non-Maximum Suppression (NMS) to obtain the centerline points and local unoriented tangent estimates. On top of these, NMS-MST uses the KNN (K = 500) graph of the centerline points to build the MST. Note that the KNN graph is symmetric such that a pair of nodes have an arc as long as one is a neighbor of the other. Here, the undirected edge weight is computed by the sum of two shorter arc lengths. GridMST uses [34] for estimating the centerline points and ï¬‚ow direction. Then, it also uses the KNN graph of the centerline points to build the MST.
GridArb uses the set of centerline points and ï¬‚ow estimates produced by [34], but it uses the conï¬‚uent tubular graph to build the minimum arborescence (dis-

cussed in Sec. 3.3). MArb exploits a modiï¬ed version of [34] (see Appendix B) and also uses the conï¬‚uent tubular graph to build the minimum arborescence. We set Îµ = Ï€2 in (5) for all our experiments.

Method
NMS-MST GridMST GridArb
MArb

Flow estimates Frangi et al. [9] Zhang et al. [34] Zhang et al. [34] Modiï¬ed [34], see suppl materials

Graph Weights standard geodesic our conï¬‚uent (5)

Tree Extraction
MST
minimum arborescence

4.1. Validation Measures
Many validation measures rely on matching between the ground truth and the predicted tree. Matching algorithms could be separated into several groups. First, match the nodes of the trees independently based on a distance measure, e.g. [34, 28, 31], partial (local) subtree matching [12], or global tree matching approaches [17, 33, 3]. We base our evaluation approach on the ï¬rst group of methods due to their eï¬ƒciency and the size of our problem.
Centerline reconstruction quality. Our reconstructed tree is ideally the centerline of the vasculature. We compute the recall and fall-out statistics of the centerline points to evaluate the reconstruction quality. To obtain the centerline receiver operating characteristic (ROC) curve, we generate a sequence of recall /fall-out points by varying the detection threshold parameter for the low-level vessel ï¬lter of Frangi et al. [9].
Similarly to [34], a speciï¬c point on the ground truth centerline is considered detected correctly (recall) iï¬€ it is located within max(r, Î¶) distance of a reconstructed tree where r is the radius of theâˆšcorresponding ground truth vessel segment and Î¶ = 22 voxel-size. A point on the reconstructed tree that is farther away than this distance is considered incorrectly detected (fall-out). Before computing the ROC curve we re-sample uniformly both the ground truth and reconstructed trees.
Bifurcation reconstruction quality. We introduce two separate metrics. First, we compute the ROC curve for only bifurcation points to assess the quality of detection. Second, we measure the median angular error at the reconstructed bifurcations to assess the accuracy, where we match all ground truth bifurcations to closet branching points on the detected tree regardless of their proximity and use the median rather than the average for greater stability. The diï¬€erence between our angular error measure and that in [34] is discussed in Appendix C.

noise std 10 Recall ratio

100%

95%

90%

85%

80%

75%

NMS-MST

70%

GridMST

65%

GridArb MArb

60%0% 5% 10% 15% 20% 25% 30% 35% 40%

Fall-out ratio

100%

95%

90%

85%

80%

75%

NMS-MST

70%

GridMST

65%

GridArb MArb

60%0% 5% 10% 15% 20% 25% 30% 35% 40%

Fall-out ratio

(a) centerline detection

Recall ratio

Recall ratio

90%

85%

80%

75%

70%

NMS-MST

GridMST

65%

GridArb

MArb

60%10% 15% 20% 25% 30% 35% 40%

Fall-out ratio

90%

85%

80%

75%

70%

NMS-MST

GridMST

65%

GridArb

MArb

60%10% 15% 20% 25% 30% 35% 40%

Fall-out ratio

(b) bifurcation detection

noise std 15 Recall ratio

Figure 8: Quantitative comparison. Our methods are denoted by MArb and GridArb. GridMST is the best result from [34].

noise std 10

noise std 15

33.0

33.0

Angle Error, degree Angle Error, degree

30.5

NMS-MST

30.5

NMS-MST

28.0

GridMST

28.0

GridMST

25.5

GridArb (our) MArb (our)

25.5

GridArb (our) MArb (our)

23.0

23.0

20.5

20.5

18.0

18.0

15.50.005

0.040

0.080 0.120 0.1600.200

Threshold Value

15.50.005

0.040

0.080 0.120 0.1600.200

Threshold Value

Figure 9: Median branching angular error for our methods (GridArb and MArb from Sec. 3) outperform all competitors (NMS-MST and GridMST [34])

Figure 10: Real data micro-CT volume and vessel centerline reconstruction (green) obtained by our method and (blue) by [34]. To reduce clutter we show the result of Frangi et al. ï¬lter [9] instead of raw input data. The real data zoom-in is at the top left.

4.2. Synthetic Data with Ground Truth
One of the major challenges in large-scale vessel tree reconstruction is the lack of ground truth. That complicates many interactive and supervised learning methods and makes evaluation hard. Zhang et al. [34] generated and published a dataset with ground truth using [14]. We used our newly generated 15 volumes (see Appendix D) 100 Ã— 100 Ã— 100 with intensities between 0 and 512. Our new dataset has a larger variance of bifurcation angles. The voxel size is 0.046 mm. We add Gaussian noise with std 10 and 15.
Fig. 8 compares the results of our methods with two competitors. One is the method of [34], another baseline is simple MST computed over non-maximum suppression of vessel ï¬lter output. All methods use essentially the same detection mechanism, i.e. Frangi et al. ï¬lter, so the centerline extraction quality does not differ much. On the other hand, our method signiï¬cantly outperforms in the quality of bifurcation detection, see Fig. 8 (b). This result is complemented by superior angular errors in Fig. 9. We attribute this to the sub-

voxel accuracy and better reconstruction of bifurcation. A typical example is shown in Fig. 1(b,c).
The GridArb performs competitively in terms of angular errors but gives the worst results in terms of centerline quality. This is due to the artifact caused by some inconsistent ï¬‚ow estimates near the tree periphery (see Fig. 13 for concrete examples). In Sec. 3.3 we argue that enlarging the regularization neighborhood helps improve the estimation of the ï¬‚ow orientation.
4.3. High Resolution Microscopy CT
We use challenging microscopy computer tomography volume (micro-CT) of size 585Ã—525Ã—892 voxels to qualitatively demonstrate the advantages of our approach. The data is a high-resolution image of mouse heart obtained ex vivo with the use of contrast. The resolution allows detecting nearly capillary level vessels, which are partially resolved (partial volume). Fig. 10 shows the whole volume and reconstruction.

References
[1] Fethallah Benmansour and Laurent D Cohen. Tubular structure segmentation based on minimal path method and anisotropic enhancement. IJCV, 92(2):192â€“210, 2011. 2
[2] Da Chen, Jean-Marie Mirebeau, and Laurent D Cohen. Global minimum for a ï¬nsler elastica minimal path approach. International Journal of Computer Vision, 122(3):458â€“483, 2017. 2
[3] Egor Chesakov. Vascular tree structure: Fast curvature regularization and validation. Electronic Thesis and Dissertation Repository. The University of Western Ontario, (3396), 2015. Master of Science thesis. 7
[4] Anthony D DeRose. Geometric continuity: a parametrization independent measure of continuity for computer aided geometric design. Technical report, CA Univ Berkeley Dept of Electrical Engineering and Computer Sciences, 1985. 3
[5] Thomas Deschamps and Laurent D. Cohen. Fast extraction of minimal paths in 3d images and applications to virtual endoscopy. Medical Image Analysis, 5(4):281 â€“ 299, 2001. 2
[6] Jack Edmonds. Optimum branchings. J. Res. Nat. Bur. Standards, 71B(4), October- December 1967. 3
[7] M. A. T. Figueiredo and J. M. N. Leitao. A nonsmoothing approach to the estimation of vessel contours in angiograms. IEEE Transactions on Medical Imaging, 14(1):162â€“172, March 1995. 2
[8] AH Fowler and CW Wilson. Cubic spline: A curve ï¬tting routine. Technical report, Union Carbide Corp., Oak Ridge, Tenn. Y-12 Plant, 1966. 3
[9] Alejandro F Frangi, Wiro J Niessen, Koen L Vincken, and Max A Viergever. Multiscale vessel enhancement ï¬ltering. In MICCAIâ€™98, pages 130â€“137. Springer, 1998. 1, 2, 7, 8, 12
[10] William T. Freeman and Edward H Adelson. The design and use of steerable ï¬lters. IEEE Transactions on Pattern Analysis & Machine Intelligence, (9):891â€“906, 1991. 1, 2
[11] Harold N Gabow, Zvi Galil, Thomas Spencer, and Robert E Tarjan. Eï¬ƒcient algorithms for ï¬nding minimum spanning trees in undirected and directed graphs. Combinatorica, 6(2):109â€“122, 1986. 7
[12] Todd A Gillette, Kerry M Brown, and Giorgio A Ascoli. The diadem metric: comparing multiple reconstructions of the same neuron. Neuroinformatics, 9(2-3):233, 2011. 7

[13] GermÂ´an GonzÂ´alez, FrancÂ¸ois Fleuret, and Pascal Fua. Automated delineation of dendritic networks in noisy image stacks. In European Conference on Computer Vision, pages 214â€“227. Springer, 2008. 1, 2, 3
[14] Ghassan Hamarneh and Preet Jassi. Vascusynth: simulating vascular trees for generating volumetric image data with ground-truth segmentation and tree analysis. Computerized medical imaging and graphics, 34(8):605â€“616, 2010. 8, 13
[15] Peter Hui, Michael J Pelsmajer, Marcus Schaefer, and Daniel Stefankovic. Train tracks and conï¬‚uent drawings. Algorithmica, 47(4):465â€“479, 2007. 3
[16] Julien Jomier, Vincent LeDigarcher, and Stephen R Aylward. Automatic vascular tree formation using the mahalanobis distance. In International Conference on Medical Image Computing and Computer-Assisted Intervention, pages 806â€“812. Springer, 2005. 3, 6
[17] Philip N. Klein. Computing the edit-distance between unrooted ordered trees. pages 91â€“102, 1998. 7
[18] Max W K Law and Albert C S Chung. Three dimensional curvilinear structure detection using optimally oriented ï¬‚ux. In European conference on computer vision, pages 368â€“382. Springer, 2008. 1, 2
[19] Hua Li and Anthony Yezzi. Vessels as 4-d curves: Global minimal 4-d paths to extract 3-d tubular surfaces and centerlines. IEEE transactions on medical imaging, 26(9):1213â€“1223, 2007. 2
[20] Dmitrii Marin, Yuchen Zhong, Maria Drangova, and Yuri Boykov. Thin structure estimation with curvature regularization. In International Conference on Computer Vision (ICCV), 2015. 1, 2, 3
[21] OdyssÂ´ee Merveille, BenoË†Ä±t Naegel, Hugues Talbot, and Nicolas Passat. nD variational restoration of curvilinear structures with prior-based directional regularization. IEEE Transactions on Image Processing, 28(8):3848â€“3859, 2019. 1
[22] OdyssÂ´ee Merveille, Hugues Talbot, Laurent Najman, and Nicolas Passat. Curvilinear structure analysis by ranking the orientation responses of path operators. IEEE transactions on pattern analysis and machine intelligence, 40(2):304â€“317, 2017. 1
[23] Stefano Moriconi, Maria A Zuluaga, H Rolf JÂ¨ager, Parashkev Nachev, SÂ´ebastien Ourselin, and M Jorge Cardoso. Inference of cerebrovascular topology with geodesic minimum spanning trees.

IEEE transactions on medical imaging, 38(1):225â€“ 239, 2018. 1, 2, 3
[24] Pierre Parent and Steven W Zucker. Trace inference, curvature consistency, and curve detection. PAMI, 11:823â€“839, 1989. 1, 2, 5, 6
[25] Hanchuan Peng, Fuhui Long, and Gene Myers. Automatic 3d neuron tracing using all-path pruning. Bioinformatics, 27(13):i239â€“i247, 2011. 2
[26] Kaleem Siddiqi and Stephen Pizer. Medial representations: mathematics, algorithms and applications, volume 37. Springer Science & Business Media, 2008. 1
[27] R. E. Tarjan. Finding optimum branchings. Networks, 7(1):25â€“35, 1977. 3
[28] Engin Turetken, Carlos Becker, Przemyslaw Glowacki, Fethallah Benmansour, and Pascal Fua. Detecting irregular curvilinear structures in gray scale and color imagery using multi-directional oriented ï¬‚ux. In Proceedings of the IEEE International Conference on Computer Vision, pages 1553â€“1560, 2013. 1, 2, 3, 7
[29] Engin Turetken, Fethallah Benmansour, Bjoern Andres, Przemyslaw Glowacki, Hanspeter Pï¬ster, and Pascal Fua. Reconstructing curvilinear networks using path classiï¬ers and integer programming. IEEE Transactions on Pattern Analysis and Machine Intelligence (TPAMI), 38(12):2515â€“ 2530, December 2016. 2, 3
[30] Engin Turetken, German Gonzalez, Christian Blum, and Pascal Fua. Automated reconstruction of dendritic and axonal trees by global optimization with geometric priors. Neuroinformatics, 9(2-3):279â€“302, 2011. 2, 3, 6
[31] J. A. Tyrrell, E. di Tomaso, D. Fuja, R. Tong, K. Kozak, R. K. Jain, and B. Roysam. Robust 3d modeling of vasculature imagery using superellipsoids. IEEE Transactions on Medical Imaging, 26(2):223â€“237, Feb 2007. 7
[32] Jun Xie, Ting Zhao, Tzumin Lee, Eugene Myers, and Hanchuan Peng. Automatic neuron tracing in volumetric microscopy images with anisotropic path searching. In International Conference on Medical Image Computing and Computer-Assisted Intervention, pages 472â€“479. Springer, 2010. 1, 2, 3
[33] Kaizhong Zhang and Dennis Shasha. Simple fast algorithms for the editing distance between trees and related problems. SIAM journal on computing, 18(6):1245â€“1262, 1989. 7
[34] Zhongwen Zhang, Dmitrii Marin, Egor Chesakov, Marc Moreno Maza, Maria Drangova, and Yuri

Boykov. Divergence prior and vessel-tree reconstruction. In IEEE conference on Computer Vision and Pattern Recognition (CVPR), Long Beach, California, June 2019. 1, 2, 3, 6, 7, 8, 11, 12, 13

Appendices
A. The proof of Property 1
Proof. First, we only consider the circle going through p, q and tangential to some vector Ï„Â¯p as shown in Fig. 11. Moving the tangent vector Ï„Â¯p in its direc-
ğ’‘ ğ’‘
ğ’’

tion along the circle yields another tangent vector Ï„Â¯q
at q. We also translate Ï„Â¯p to q. By construction, âˆ†Opq
is equilateral. Thus, âˆ Opq = âˆ Oqp. Since Ï„Â¯p and
Ï„Â¯q are tangential to the circle, we have Î± + âˆ Opq = Î² + âˆ Oqp = Ï€2 , which obviously gives Î± = Î². WLOG, we assume vectors Ï„Â¯p, Ï„Â¯q and eÂ¯ are all unit vectors. As
Î± = Î², we have:

Ï„Â¯q = 2[(Ï„Â¯p Â· eÂ¯)eÂ¯ âˆ’ Ï„Â¯p] + Ï„Â¯p

(9)

Now, we consider the two circles going through both p and q while one is tangential to Â¯lp and the other is tangential to the Â¯lq as shown in Fig. 12. Note that these two circles are not necessarily co-planar. Using
(9), we can obtain

cË˜1pq = 2[(cË˜0pq Â· e1)e1 âˆ’ cË˜0pq] + cË˜0pq

(10)

cË˜1qp = 2[(cË˜0qp Â· e1)e1 âˆ’ cË˜0qp] + cË˜0qp

(11)

To prove (6), it is suï¬ƒcient to prove equality of the two dot products which can be simpliï¬ed using (10) and (11):

cË˜1pq Â· cË˜0qp = 2(cË˜0pq Â· e1)(cË˜0qp Â· e1) âˆ’ cË˜0pq Â· cË˜0qp

(12)

Figure 11: Illustration for (9). O is the center of the circle. eÂ¯ is a unit vector along pq.
ğ‘Ì† ğ‘™Ì… = ğ‘Ì†
ğ‘™Ì… = ğ‘Ì†
Figure 12: Two circles given by p,q, cË˜0pq and cË˜0qp. Vectors in red are co-planar with the red circle while those in maroon are co-planar with the maroon circle.

cË˜1qp Â· cË˜0pq = 2(cË˜0qp Â· e1)(cË˜0pq Â· e1) âˆ’ cË˜0qp Â· cË˜0pq

(13)

It is obvious that the RHS of (12) and (13) are equal. Therefore, these two angles are equal.

B. CRF Regularization Neighborhood
Our tree extraction method is based on a directed conï¬‚uent tubular graph construction G = V, A presented in Sec. 3 of the paper. We proposed an approach that builds conï¬‚uent ï¬‚ow-extrapolating arcs cË˜pq for our graph from estimated oriented ï¬‚ow vectors {Â¯lp | p âˆˆ V }. Speciï¬c ï¬‚ow orientations can be computed from Frangi ï¬lter outputs using standard MRF/CRF regularization methods [34] enforcing divergence (or convergence) of the ï¬‚ow pattern. However, as mentioned in Sec. 3.3 and Sec. 4, we modiï¬ed [34] by anisotropically enlarging the regularization neighborhood to improve the estimates of ï¬‚ow orientations, which are important for our directed arc construction. The 26-grid neighborhood regularization used in [34] generates too many CRF connectivity gaps near the vessel tree periphery where the signal gets weaker. Such gaps result in ï¬‚ow orientation errors, see white vectors in the zoom-ins in Fig. 13(a,b). While tree reconstruction on standard undirected geodesic tubular graphs, see Fig. 13(a), are oblivious to such errors, our directed conï¬‚uent tubular graph construction is sensitive to wrong orientations,

tree reconstruction (blue) on undirected Tubular Graph (standard)
GridMST

tree reconstructions (red and green) on directed Conï¬‚uent Tubular Graph (our)

GridArb

MArb

(a) Flow pattern estimate (white) [34] + MST on geodesic tubular graph

(b) Flow pattern estimate (white) [34] + min. arb. on conï¬‚uent tubular graph

(c) Improved ï¬‚ow estimate (white) + min. arb. on conï¬‚uent tubular graph

Figure 13: Typical tree reconstruction examples for standard (a) and our conï¬‚uent (b,c) tubular graphs. (a) White vectors represent CRF-based ï¬‚ow pattern estimates [34] using 26-grid regularization neighborhood N . In case of thin sub-voxel vessels, such N has gaps creating inconsistent ï¬‚ow pattern for isolated small branches (yellow box) lacking bifurcations used by divergence prior to disambiguate orientations. (a) Undirected geodesic tubular graph with large KNN easily bridges such gaps ignoring (inconsistent) ï¬‚ow directions and produces topologically valid vessel MST (blue), even though bifurcations are not accurate. (b) Directed conï¬‚uent tubular graph is sensitive to ï¬‚ow pattern errors. Minimum arborescence on this graph produces accurate bifurcations, but ï¬‚ow orientation errors (yellow box) lead to wrong topology. (c) CRF-based ï¬‚ow pattern estimator [34] with modiï¬ed anisotropic KNN system N addresses the gaps at thin vessels. This improves ï¬‚ow orientations (white vectors in yellow box) and resolves conï¬‚uent tubular graph artifacts producing trees with accurate both topology and bifurcations.

see Fig. 13(b). To address CRF gaps in the ï¬‚ow orientation estimator [34], we modiï¬ed their 26-grid regularization neighborhood into anisotropic KNN based on Frangiâ€™s vessel tangents [9]. This signiï¬cantly reduces orientation errors in {Â¯lp | p âˆˆ V } and resolves conï¬‚uent tubular graph artifacts, see Fig. 13(c). We detail anisotropic KNN below.
CRF connectivity quality: Besides the size of the neighborhood K, anisotropic KNN system has another important hyper-parameter, aspect ratio ar. To select better parameters K and ar, we can evaluate CRF connectivity system N using ROC curves for synthetic vasculature volumes with ground truth. We consider an edge in N as correct iï¬€ the projections of its ends onto the ground truth tree have parent/descendant relationship. The recall is the portion of the ground truth tree covered by the correct edges. The fall-out is the ratio of incorrect edges to the total edge count.
As shown in Fig. 14, simply increasing the size of neighborhood closes many gaps but, in the meantime, introduces a lot of spurious connections between diï¬€erent vessel branches. Thus, we propose to use anisotropic neighborhoods. Speciï¬cally, the regularization neighborhood is redeï¬ned as k anisotropic nearest

neighbors instead of regular grid connectivity. This similar to the KNN except Mahalanobis distance is used. This modiï¬cation addresses the issue giving the state-of-the-art result, see Fig.13(c). To implement such anisotropic neighborhood system, we ï¬rst built an isotropic KNN with some large K, eg. K=500. Then, for each node and its neighbors, we transformed the Euclidean distance into Mahalanobis distance based on the tangent direction on the node. After this, we selected K (eg. K=4) nearest neighbors for each node again based on the Mahalnobis distance. Note that such anisotropic neighborhood is symmetric since we consider a pair of nodes as neighbor as long as one is connected to the other.
C. Angular Error Measure
The average angular error introduced in [34] uses only correctly detected points to compute the bifurcation angular errors. Using such matching to compare diï¬€erent methods is unfair as for a particular detection threshold these methods correctly detect diï¬€erent sets of bifurcations. So, we match all ground truth bifurcations to closet branching points on the detected tree regardless of their proximity. For certain thresholds, this causes many incorrectly matched bifurcation and

99.0%

...

4-ANN graph

98.5%

Recall

98.0%
97.5% 2-ANN graph

97.0%
96.5% 5%

1-ANN graph

10%

15%

20%

Fall-out

7-ANN graph

ar1 ar4 ar7 ar10 ar20 ar40 grid26

25%

30%

Figure 14: (Quasi) ROC curves evaluating accuracy of the neighborhoods N used for ï¬‚ow pattern estimation, as in [34]. We compare anisotropic KNNs and standard 26-grid connectivity (see gray dot). Evaluation is done based on synthetic data with ground truth where correct connectivity is available. â€œarâ€ stands for the aspect ratio and the number denotes the square of the aspect ratio. â€œgrid26â€ represent the regular 26 neighbors on grid. We select â€œar10â€ with 4 anisotropic nearest neighbourhood (ANN) connectivity system.
large errors. Despite that such statistic is inï¬‚uenced signiï¬cantly by random matches, it is meaningful for comparing diï¬€erent reconstruction methods.
D. Synthetic Data with Ground Truth
Zhang et al. [34] generated and published a dataset with ground truth using [14]. We found that the diversity of bifurcation angles is limited. The mean angle is 68â—¦ and std is 17â—¦. To increase the angle variance, we introduce a simple modiï¬cation of vessel tree generation. When a new bifurcation is created from a point and existing line segment, we move the bifurcation towards one of the segmentâ€™s ends chosen at random decreasing the distance by half. The new mean is 68â—¦ and std is 29â—¦. We generate 15 volumes 100Ã—100Ã—100 with intensities between 0 and 512. The voxel size is 0.046 mm. We add Gaussian noise with std 10 and 15.

